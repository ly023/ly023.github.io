<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>朝花夕拾</title>
  
  <subtitle>视界之外，想象之中</subtitle>
  <link href="http://yoursite.com/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2022-09-01T07:45:32.187Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>多义词</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Tidio聊天组件z-index过高问题</title>
    <link href="http://yoursite.com/2022/09/01/Tidio%E8%81%8A%E5%A4%A9%E7%BB%84%E4%BB%B6z-index%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2022/09/01/Tidio%E8%81%8A%E5%A4%A9%E7%BB%84%E4%BB%B6z-index%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98/</id>
    <published>2022-09-01T07:01:00.942Z</published>
    <updated>2022-09-01T07:45:32.187Z</updated>
    
    <content type="html"><![CDATA[<p>问题：<code>Tidio</code>生成的iframe<code>z-index</code>为<code>999999999 !important</code>，css无法修改ifram样式。</p><a id="more"></a><p>解决方法：通过监听<code>Tidio</code>提供的<code>ready</code>事件，用js修改<code>zIndex</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onTidioChatApiReadyChangeZIndex</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> tidioChatIframe = <span class="built_in">document</span>.getElementById(<span class="string">'tidio-chat-iframe'</span>);</span><br><span class="line">    <span class="keyword">if</span> (tidioChatIframe) &#123;</span><br><span class="line">        tidioChatIframe.style.zIndex = <span class="string">'2'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.tidioChatApi) &#123;</span><br><span class="line">    <span class="built_in">window</span>.tidioChatApi.on(<span class="string">'ready'</span>, onTidioChatApiReadyChangeZIndex);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">'tidioChat-ready'</span>, onTidioChatApiReadyChangeZIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;问题：&lt;code&gt;Tidio&lt;/code&gt;生成的iframe&lt;code&gt;z-index&lt;/code&gt;为&lt;code&gt;999999999 !important&lt;/code&gt;，css无法修改ifram样式。&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>Safari兼容性问题（macOS与iOS）</title>
    <link href="http://yoursite.com/2022/08/13/Safari%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98%EF%BC%88macOS%E4%B8%8EiOS%EF%BC%89/"/>
    <id>http://yoursite.com/2022/08/13/Safari%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98%EF%BC%88macOS%E4%B8%8EiOS%EF%BC%89/</id>
    <published>2022-08-13T04:09:35.090Z</published>
    <updated>2022-09-28T02:22:10.463Z</updated>
    
    <content type="html"><![CDATA[<p>记录项目开发过程中遇到的一些Safari兼容性问题。</p><!--- iOS Safari下设置100vh会出现滚动条--><ul><li>Safari下overflow:hidden + border-radius失效</li></ul><a id="more"></a><!--## iOS Safari 100vh问题iOS 15 Safari浏览器，有`Single Tab`和`Tab Bar`两种tab模式：- `Single Tab`模式：地址栏显示在浏览器顶部，即旧的地址栏显示模式- `Tab Bar`模式：地址栏与标签页在浏览器底部，iOS 15新增模式问题描述：容器设置`height: 100vh`填充屏幕，在Safari浏览器下会出现滚动条，部分内容被头部或底部的bar遮挡。解决方案：<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span><br><span class="line">  min-height: -webkit-fill-available;  // iOS safari</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意，如果设置为<code>height</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.container &#123;</span><br><span class="line">  height: 100vh;</span><br><span class="line">  height: -webkit-fill-available;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>Single Tab</code>模式下没有问题，在iOS 15的<code>Tab Bar</code>模式下，当页面隐藏底部导航栏留出空间的时候，内容高度不会自动撑满。</p><p>参考：<a href="https://allthingssmitty.com/2020/05/11/css-fix-for-100vh-in-mobile-webkit/">https://allthingssmitty.com/2020/05/11/css-fix-for-100vh-in-mobile-webkit/</a><br>–&gt;</p><h2 id="Safari下overflow-hidden-border-radius失效"><a href="#Safari下overflow-hidden-border-radius失效" class="headerlink" title="Safari下overflow:hidden + border-radius失效"></a>Safari下overflow:hidden + border-radius失效</h2><p>Safari下，父元素设置<code>overflow: hidden</code> + <code>border-radius</code>，子元素<code>hover</code>放大时，父元素<code>border-radius</code>的限制无效：</p><p class="codepen" data-height="360" data-default-tab="html,result" data-slug-hash="ExEdxYj" data-user="ly023" style="height: 360px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/ExEdxYj">  Untitled</a> by ly023 (<a href="https://codepen.io/ly023">@ly023</a>)  on <a href="https://codepen.io">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><p><a href="https://stackoverflow.com/questions/49066011/overflow-hidden-with-border-radius-not-working-on-safari">https://stackoverflow.com/questions/49066011/overflow-hidden-with-border-radius-not-working-on-safari</a></p><p>解决方法：在设置<code>overflow: hidden</code>的元素上添加<code>transform: translateZ(0);</code></p><p class="codepen" data-height="360" data-default-tab="html,result" data-slug-hash="xxWyxwO" data-user="ly023" style="height: 360px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/xxWyxwO">  Safari下overflow:hidden + border-radius兼容问题解决方案</a> by ly023 (<a href="https://codepen.io/ly023">@ly023</a>)  on <a href="https://codepen.io">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>-->]]></content>
    
    
    <summary type="html">&lt;p&gt;记录项目开发过程中遇到的一些Safari兼容性问题。&lt;/p&gt;
&lt;!--- iOS Safari下设置100vh会出现滚动条--&gt;
&lt;ul&gt;
&lt;li&gt;Safari下overflow:hidden + border-radius失效&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="浏览器兼容性" scheme="http://yoursite.com/categories/浏览器兼容性/"/>
    
    
    <category term="Safari" scheme="http://yoursite.com/tags/Safari/"/>
    
  </entry>
  
  <entry>
    <title>选择Dropbox网盘文件-Chooser API</title>
    <link href="http://yoursite.com/2022/08/02/Dropbox%20Chooser%20API/"/>
    <id>http://yoursite.com/2022/08/02/Dropbox%20Chooser%20API/</id>
    <published>2022-08-02T02:19:11.313Z</published>
    <updated>2022-08-03T00:59:25.197Z</updated>
    
    <content type="html"><![CDATA[<p>选择Dropbox网盘中的文件。</p><a id="more"></a><h2 id="Chooser-API"><a href="#Chooser-API" class="headerlink" title="Chooser API"></a>Chooser API</h2><p><a href="https://www.dropbox.com/developers/chooser" target="_blank" rel="noopener">Chooser</a> </p><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><h3 id="1-创建Dropbox账号"><a href="#1-创建Dropbox账号" class="headerlink" title="1. 创建Dropbox账号"></a>1. 创建Dropbox账号</h3><p>创建Dropbox账号，上传一些文件。</p><h3 id="2-创建应用"><a href="#2-创建应用" class="headerlink" title="2. 创建应用"></a>2. 创建应用</h3><p>在<a href="https://www.dropbox.com/developers/apps/create?_tk=support_lp&_ad=faq9&_camp=create" target="_blank" rel="noopener">应用创建页面</a>上创建应用，获取<code>App key</code>和<code>App secret</code>，使用<code>Chooser</code>只需要<code>App key</code>。</p><p>具体步骤：Choose an API –&gt; Full Dropbox– Access to all files and folders in a user’s Dropbox. –&gt; Name your app –&gt; Create app。</p><p>注意app名称不要带有Dropbox等字眼，具体规则看<a href="https://www.dropbox.com/developers/reference/branding-guide" target="_blank" rel="noopener">Developer branding guide</a>。</p><p>创建成功后会自动跳转到<a href="https://www.dropbox.com/developers/apps?_tk=support_lp&_ad=faq10&_camp=myapps" target="_blank" rel="noopener">应用控制台</a>，显示所需要的<code>App key</code>和其他配置项。需要对<code>Chooser / Saver / Embedder domains</code>进行配置，添加使用<code>Chooser API</code>的网站域名。</p><h3 id="3-使用"><a href="#3-使用" class="headerlink" title="3. 使用"></a>3. 使用</h3><p>加载sdk（<code>data-app-key</code>要替换成应用的<code>App key</code>）：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"https://www.dropbox.com/static/api/2/dropins.js"</span> <span class="attr">id</span>=<span class="string">"dropboxjs"</span> <span class="attr">data-app-key</span>=<span class="string">"YOU_APP_KEY"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="自定义触发"><a href="#自定义触发" class="headerlink" title="自定义触发"></a>自定义触发</h4><p>打开Dropbox文件选择弹窗：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.Dropbox.choose(options);</span><br></pre></td></tr></table></figure><p>options配置项说明查看<a href="https://www.dropbox.com/developers/chooser" target="_blank" rel="noopener">Chooser</a>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">files</span>) </span>&#123;    </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'选择的文件'</span>, files)</span><br><span class="line">    &#125;,</span><br><span class="line">    cancel: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'取消弹窗'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    linkType: <span class="string">"direct"</span>, <span class="comment">// "direct"直接返回文件资源链接，"preview"返回文件分享页链接</span></span><br><span class="line">    multiselect: <span class="literal">true</span>, <span class="comment">// true支持多选</span></span><br><span class="line">    extensions: [<span class="string">'.png'</span>, <span class="string">'.jpg'</span>, <span class="string">'.jpeg'</span>], <span class="comment">// 限制只能选择png和jpg类型的图片</span></span><br><span class="line">    folderselect: <span class="literal">false</span>, <span class="comment">// 是否可以选择文件夹，linkType为"direct"的时候不能设置为true</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>返回的文件数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"id"</span>: <span class="string">"id:WpAf-GzjCZgAAAAAAAAADw"</span>,</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"18071524.jpeg"</span>,</span><br><span class="line">    <span class="string">"bytes"</span>: <span class="number">45853</span>,</span><br><span class="line">    <span class="string">"isDir"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">"link"</span>: <span class="string">"https://dl.dropboxusercontent.com/1/view/vskds5y4eqav5mh/18071524.jpeg"</span>,</span><br><span class="line">    <span class="string">"linkType"</span>: <span class="string">"direct"</span>,</span><br><span class="line">    <span class="string">"icon"</span>: <span class="string">"https://www.dropbox.com/static/images/icons64/page_white_picture.png"</span>,</span><br><span class="line">    <span class="string">"thumbnailLink"</span>: <span class="string">"https://ucdce874f44aecc28a15acffe249.previews.dropboxusercontent.com/p/thumb/ABn6sMa1daeLW-siy1ee4zAws08Bp1aZG-9iuecGznEeDJkRmDMFFdEsiXS-wEVNE-UN5o7lFq0Ny2UxmHcJz7cIMoc0HWBOrAe5FbcfvIApoYH_CQXEDTGT1Fi-5sZzWkU6rheGzgJGFFto6VlQIAYZDNtPVdfAf_gF0HDVMcvEpSxRxQ7z4irCWwifqiM0PACLCQYg14B0ENjWaaGRIw2m3Aip4Cez-NwYUBz7sZOOrV6AEibPeVPmRUD5LLYvCn7b6FNHC1QktsgIDmFgaCDY9l5v2J-pO6viDp9phgXycS7xJCeZQPUvzGI3SNdkkzA48EvYJchup1weDvM8QYt3fbeXBT12WmQGtdDfLm4RFfBddNOcWP6UfSswjTwB_yE/p.jpeg?bounding_box=75&amp;mode=fit"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用官方触发按钮"><a href="#使用官方触发按钮" class="headerlink" title="使用官方触发按钮"></a>使用官方触发按钮</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> button = Dropbox.createChooseButton(options);</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"container"</span>).appendChild(button);</span><br></pre></td></tr></table></figure><!--## Demohttps://stackblitz.com/edit/react-b9k9yn?file=src/App.js--><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="应该使用哪个API"><a href="#应该使用哪个API" class="headerlink" title="应该使用哪个API"></a>应该使用哪个API</h3><p><a href="https://www.dropbox.com/developers/support" target="_blank" rel="noopener">https://www.dropbox.com/developers/support</a></p><blockquote><p>如果您正在为应用寻找 UI 组件，以便其他人在您的应用中打开 Dropbox 中的文件或从您的应用中将文件保存到 Dropbox，请使用<a href="https://www.dropbox.com/developers/chooser?_tk=support_lp&_ad=faq4&_camp=chooser" target="_blank" rel="noopener">Chooser</a>和<a href="https://www.dropbox.com/developers/saver?_tk=support_lp&_ad=faq5&_camp=saver" target="_blank" rel="noopener">Saver</a></p></blockquote><blockquote><p>如果您需要基于HTTP的API（例如需要面向服务器端 Web 应用），或者需要更低级别的Dropbox访问权限，请使用<a href="https://www.dropbox.com/developers/documentation/http/documentation?_tk=support_lp&_ad=faq6&_camp=http" target="_blank" rel="noopener">User API</a></p></blockquote><blockquote><p>如果您需要访问Dropbox Business管理功能，请使用<a href="https://www.dropbox.com/developers/documentation/http/teams?_tk=support_lp&_ad=faq7&_camp=biz" target="_blank" rel="noopener">Dropbox Business API</a></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;选择Dropbox网盘中的文件。&lt;/p&gt;</summary>
    
    
    
    <category term="API" scheme="http://yoursite.com/categories/API/"/>
    
    
    <category term="Dropbox" scheme="http://yoursite.com/tags/Dropbox/"/>
    
  </entry>
  
  <entry>
    <title>项目配置Stylelint校验CSS与SCSS文件</title>
    <link href="http://yoursite.com/2022/07/21/%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AEStylelint%E6%A0%A1%E9%AA%8CCSS%E4%B8%8ESCSS%E6%96%87%E4%BB%B6/"/>
    <id>http://yoursite.com/2022/07/21/%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AEStylelint%E6%A0%A1%E9%AA%8CCSS%E4%B8%8ESCSS%E6%96%87%E4%BB%B6/</id>
    <published>2022-07-21T02:13:52.538Z</published>
    <updated>2022-08-03T00:57:15.360Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://stylelint.io/user-guide/get-started" target="_blank" rel="noopener">Stylelint官方文档 Getting started</a></p><p><a href="https://stylelint.docschina.org/user-guide/" target="_blank" rel="noopener">Stylelint中文文档</a></p><p><strong><a href="https://stylelint.io/user-guide/get-started/#using-a-community-shared-config" target="_blank" rel="noopener">官方推荐配置</a></strong></p><a id="more"></a><p>有多种配置方法，下面介绍其中一种方法。</p><!--`stylelint` + `stylelint-config-standard` + `stylelint-order` + `stylelint-scss` +  `stylelint-config-prettier`--><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D stylelint stylelint-config-standard-scss stylelint-config-prettier-scss</span><br></pre></td></tr></table></figure><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>添加配置文件：</p><ul><li><p>根目录创建<code>.stylelintrc.json</code>用于stylelint规则配置，文件名可以是<a href="https://stylelint.io/user-guide/configure/" target="_blank" rel="noopener">其他</a></p></li><li><p>根目录创建<code>.stylelintignore</code>，忽略特定的文件，配置规则与<code>.gitignore</code>一样。也可以在<code>stylelintrc.json</code>配置<code>ignoreFiles</code>，默认忽略<code>node_modules</code>目录，如果需要忽略大量文件，用<code>.stylelintignore</code>比较好</p></li></ul><h3 id="stylelint-config-standard-scss"><a href="#stylelint-config-standard-scss" class="headerlink" title="stylelint-config-standard-scss"></a>stylelint-config-standard-scss</h3><p><a href="https://github.com/stylelint-scss/stylelint-config-standard-scss" target="_blank" rel="noopener">https://github.com/stylelint-scss/stylelint-config-standard-scss</a></p><p>Stylelint SCSS 配置，扩展自<a href="https://github.com/stylelint/stylelint-config-standard" target="_blank" rel="noopener">stylelint-config-standard</a>与<a href="https://github.com/stylelint-scss/stylelint-config-recommended-scss" target="_blank" rel="noopener">stylelint-config-recommended-scss</a>。</p><p><code>.stylelintrc.json</code>添加配置：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"extends"</span>: [<span class="string">"stylelint-config-standard-scss"</span>],</span><br><span class="line">  <span class="attr">"rules"</span>: &#123;</span><br><span class="line">   <span class="attr">"selector-pseudo-class-no-unknown"</span>: [</span><br><span class="line">      <span class="literal">true</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"ignorePseudoClasses"</span>: [<span class="string">"global"</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"color-function-notation"</span>: <span class="string">"legacy"</span>,</span><br><span class="line">    <span class="attr">"alpha-value-notation"</span>: <span class="string">"number"</span>,</span><br><span class="line">    <span class="attr">"function-url-quotes"</span>: <span class="literal">null</span>,</span><br><span class="line">     <span class="attr">"scss/dollar-variable-pattern"</span>: <span class="literal">null</span>,</span><br><span class="line">     <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>stylelint规则：<a href="https://stylelint.io/user-guide/rules/list" target="_blank" rel="noopener">https://stylelint.io/user-guide/rules/list</a></li><li>stylelint-scss规则：<a href="https://github.com/stylelint-scss/stylelint-scss" target="_blank" rel="noopener">https://github.com/stylelint-scss/stylelint-scss</a></li></ul><p>部分规则配置说明：</p><ul><li><p><a href="https://stylelint.io/user-guide/rules/list/selector-pseudo-class-no-unknown/" target="_blank" rel="noopener">“selector-pseudo-class-no-unknown”</a>：伪类选择器检查</p></li><li><p><a href="https://stylelint.io/user-guide/rules/list/color-function-notation" target="_blank" rel="noopener">“color-function-notation”</a>：默认为<code>&quot;morden&quot;</code>，会将<code>rgba</code>改为<code>rgb</code>，设置<code>&quot;legacy&quot;</code>不转化</p></li><li><p><a href="https://stylelint.io/user-guide/rules/list/alpha-value-notation" target="_blank" rel="noopener">“alpha-value-notation”</a>：指定alpha值的表示法，默认为”percentage”百分比，设置”number”为数字表示</p></li></ul><h3 id="stylelint-config-prettier-scss"><a href="#stylelint-config-prettier-scss" class="headerlink" title="stylelint-config-prettier-scss"></a>stylelint-config-prettier-scss</h3><p>项目有使用<code>Prettier</code>的才需要安装。</p><p><code>stylelint-config-prettier-scss</code>扩展自<a href="https://github.com/prettier/stylelint-config-prettier" target="_blank" rel="noopener">stylelint-config-prettier</a>，关闭与Prettier冲突的CSS和SCSS规则。</p><p><code>.stylelintrc.json</code>添加配置：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"extends"</span>: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="string">"stylelint-config-prettier-scss"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="VS-Code配置"><a href="#VS-Code配置" class="headerlink" title="VS Code配置"></a>VS Code配置</h3><h4 id="1-安装stylelint插件"><a href="#1-安装stylelint插件" class="headerlink" title="1. 安装stylelint插件"></a>1. 安装stylelint插件</h4><h4 id="2-修改settings-json文件配置"><a href="#2-修改settings-json文件配置" class="headerlink" title="2. 修改settings.json文件配置"></a>2. 修改settings.json文件配置</h4><p><a href="https://marketplace.visualstudio.com/items?itemName=stylelint.vscode-stylelint" target="_blank" rel="noopener">vscode-stylelint配置</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"editor.codeActionsOnSave": &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  "source.fixAll.stylelint": true, // 保存时自动格式化</span><br><span class="line">&#125;,</span><br><span class="line">"stylelint.validate": ["css", "scss"], // 验证css与scss文件</span><br></pre></td></tr></table></figure><h3 id="添加自定义css属性顺序规则"><a href="#添加自定义css属性顺序规则" class="headerlink" title="添加自定义css属性顺序规则"></a>添加自定义css属性顺序规则</h3><p>可以使用<code>stylelint-order</code>自行定义CSS属性顺序，<code>.stylelintrc.json</code>添加配置：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"plugins"</span>: [</span><br><span class="line">    <span class="string">"stylelint-order"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"rules"</span>: &#123;</span><br><span class="line">    <span class="attr">"order/properties-order"</span>: [ <span class="comment">// 自定义属性排序</span></span><br><span class="line">      <span class="string">"position"</span>,</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">      ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也可以用其他定义好的顺序规则：<a href="https://github.com/hudochenkov/stylelint-order#example-configs" target="_blank" rel="noopener">Example configs</a>。</p><p>这里选取<a href="https://github.com/constverum/stylelint-config-rational-order" target="_blank" rel="noopener">stylelint-config-rational-order</a>规则，<code>.stylelintrc.json</code>添加配置：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"extends"</span>: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="string">"stylelint-config-rational-order"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="检查与修复"><a href="#检查与修复" class="headerlink" title="检查与修复"></a>检查与修复</h2><p>检查：<code>stylelint &#39;src/**/*.{css,scss}&#39;</code></p><p>修复：<code>stylelint &#39;src/**/*.{css,scss}&#39; --fix&quot;</code></p><p><code>--cache</code>选项可以指定使用缓存。</p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>问题：<a href="https://github.com/stylelint-scss/stylelint-config-standard-scss/issues/5" target="_blank" rel="noopener">TypeError: Class extends value undefined is not a constructor or null #5</a></p><p>解决方法：安装<code>postcss</code>，使用<code>postcss@8</code>版本。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://stylelint.io/user-guide/get-started&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Stylelint官方文档 Getting started&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://stylelint.docschina.org/user-guide/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Stylelint中文文档&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://stylelint.io/user-guide/get-started/#using-a-community-shared-config&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;官方推荐配置&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="构建" scheme="http://yoursite.com/categories/构建/"/>
    
    
    <category term="Stylelint" scheme="http://yoursite.com/tags/Stylelint/"/>
    
  </entry>
  
  <entry>
    <title>Canvas-透明PNG图像阴影</title>
    <link href="http://yoursite.com/2022/07/15/Canvas-%E9%80%8F%E6%98%8EPNG%E5%9B%BE%E5%83%8F%E9%98%B4%E5%BD%B1/"/>
    <id>http://yoursite.com/2022/07/15/Canvas-%E9%80%8F%E6%98%8EPNG%E5%9B%BE%E5%83%8F%E9%98%B4%E5%BD%B1/</id>
    <published>2022-07-15T01:19:21.709Z</published>
    <updated>2022-07-18T06:31:43.830Z</updated>
    
    <content type="html"><![CDATA[<p>使用Canvas为PNG图像绘制阴影。</p><a id="more"></a><h2 id="绘制阴影"><a href="#绘制阴影" class="headerlink" title="绘制阴影"></a>绘制阴影</h2><h3 id="方法1：shadowBlur-shadowColor-shadowOffsetX-shadowOffsetY"><a href="#方法1：shadowBlur-shadowColor-shadowOffsetX-shadowOffsetY" class="headerlink" title="方法1：shadowBlur + shadowColor + shadowOffsetX + shadowOffsetY"></a>方法1：shadowBlur + shadowColor + shadowOffsetX + shadowOffsetY</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/shadowBlur" target="_blank" rel="noopener">MDN CanvasRenderingContext2D.shadowBlur</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctx.shadowBlur = <span class="number">8</span>;</span><br><span class="line">ctx.shadowColor = <span class="string">'rgba(0,0,0,0.3)'</span>;</span><br><span class="line">ctx.shadowOffsetX = <span class="number">100</span>;</span><br><span class="line">ctx.shadowOffsetY = <span class="number">50</span>;</span><br></pre></td></tr></table></figure><iframe src="https://stackblitz.com/edit/js-kgwzb7?embed=1&file=index.js" width="100%" height="500"></iframe><h4 id="关于shadowBlur单位问题"><a href="#关于shadowBlur单位问题" class="headerlink" title="关于shadowBlur单位问题"></a>关于shadowBlur单位问题</h4><p><code>shadowBlur</code>的值既不对应像素值也不受当前变换矩阵的影响：</p><blockquote><p>This value doesn’t correspond to a number of pixels, and is not affected by the current transformation matrix</p></blockquote><p>可以参考<a href="https://stackoverflow.com/questions/37195064/what-are-the-units-of-canvasrenderingcontext2d-shadowblur" target="_blank" rel="noopener">What are the units of CanvasRenderingContext2D.shadowBlur?</a>这篇问答，有说明Canvas shadowBlur与CSS filter blur-radius的差别。</p><h3 id="方法2：滤镜函数drop-shadow"><a href="#方法2：滤镜函数drop-shadow" class="headerlink" title="方法2：滤镜函数drop-shadow"></a>方法2：滤镜函数drop-shadow</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/filter" target="_blank" rel="noopener">MDN CanvasRenderingContext2D.filter</a></p><p><strong>IE与Safari（包括iOS Safari）不支持。如果图像仅用于显示，可以用CSS3 filter（兼容Safari不兼容IE）代替。</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.filter = <span class="string">'drop-shadow(50px 50px 10px rgba(0, 0, 0, 0.3))'</span>;</span><br></pre></td></tr></table></figure><iframe src="https://stackblitz.com/edit/js-fkekem?embed=1&file=index.js" width="100%" height="500"></iframe><h2 id="绘制内阴影"><a href="#绘制内阴影" class="headerlink" title="绘制内阴影"></a>绘制内阴影</h2><h3 id="方法1：滤镜函数-drop-shadow-合成操作globalCompositeOperation"><a href="#方法1：滤镜函数-drop-shadow-合成操作globalCompositeOperation" class="headerlink" title="方法1：滤镜函数 drop-shadow + 合成操作globalCompositeOperation"></a>方法1：滤镜函数 drop-shadow + 合成操作globalCompositeOperation</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation" target="_blank" rel="noopener">MDN globalCompositeOperation</a></p><p><strong>IE与Safari（包括iOS Safari）不支持filter滤镜。</strong></p><p>方法来自<a href="https://stackoverflow.com/a/51198577/8373132" target="_blank" rel="noopener">Inset-shadow on HTML5 canvas image 提问的回答</a></p><iframe src="https://stackblitz.com/edit/js-ddoaih?embed=1&file=index.js" width="100%" height="500"></iframe><h3 id="方法2：合成操作-globalCompositeOperation-shadowBlur-shadowColor"><a href="#方法2：合成操作-globalCompositeOperation-shadowBlur-shadowColor" class="headerlink" title="方法2：合成操作 globalCompositeOperation + shadowBlur + shadowColor"></a>方法2：合成操作 globalCompositeOperation + shadowBlur + shadowColor</h3><p>方法来自<a href="https://stackoverflow.com/a/37380488/8373132" target="_blank" rel="noopener">Inset-shadow on HTML5 canvas image 提问的回答 Composition chain</a></p><p>4个步骤：</p><ol><li>Draw in original image</li><li>Invert alpha channel filling the canvas with a solid using xor composition</li><li>Define shadow and draw itself back in</li><li>Deactivate shadow and draw in original image (destination-atop)</li></ol><iframe src="https://stackblitz.com/edit/js-vkkebo?embed=1&file=index.js" width="100%" height="500"></iframe>]]></content>
    
    
    <summary type="html">&lt;p&gt;使用Canvas为PNG图像绘制阴影。&lt;/p&gt;</summary>
    
    
    
    <category term="Canvas" scheme="http://yoursite.com/categories/Canvas/"/>
    
    
    <category term="Canvas" scheme="http://yoursite.com/tags/Canvas/"/>
    
  </entry>
  
  <entry>
    <title>移动端开发-文本输入框</title>
    <link href="http://yoursite.com/2022/04/28/%E7%A7%BB%E5%8A%A8%E7%AB%AF-%E6%96%87%E6%9C%AC%E8%BE%93%E5%85%A5%E6%A1%86/"/>
    <id>http://yoursite.com/2022/04/28/%E7%A7%BB%E5%8A%A8%E7%AB%AF-%E6%96%87%E6%9C%AC%E8%BE%93%E5%85%A5%E6%A1%86/</id>
    <published>2022-04-28T06:33:33.310Z</published>
    <updated>2022-07-14T00:41:32.835Z</updated>
    
    <content type="html"><![CDATA[<p>记录移动端开发文本输入框常用的HTML属性。</p><a id="more"></a><h2 id="虚拟键盘inputmode属性"><a href="#虚拟键盘inputmode属性" class="headerlink" title="虚拟键盘inputmode属性"></a>虚拟键盘<code>inputmode</code>属性</h2><p>设置虚拟键盘的显示内容。</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/inputmode" target="_blank" rel="noopener">MDN inputmode</a></p><ul><li><p><code>&quot;none&quot;</code><br>无虚拟键盘。</p></li><li><p><code>&quot;text&quot;</code><br>默认值，显示标准输入键盘。</p></li><li><p><code>&quot;decimal&quot;</code><br>小数输入键盘，包含<code>0</code>到<code>9</code>的数字，小数点<code>.</code>。</p></li><li><p><code>&quot;numeric&quot;</code><br>数字输入键盘，包含<code>0</code>到<code>9</code>的数字。</p></li><li><p><code>&quot;tel&quot;</code><br>电话输入键盘，包含<code>0</code>到<code>9</code>的数字，星号（*）和井号（#）键等。表单输入里面的电话输入通常应该使用<code>&lt;input type=&quot;tel&quot;&gt;</code>。</p></li><li><p><code>&quot;search&quot;</code><br>虚拟键盘Enter键可能会显示“搜索”，或其他优化。</p></li><li><p><code>&quot;email&quot;</code><br>为邮件地址输入优化的虚拟键盘，通常包含<code>@</code>符号键和其他优化。表单里面的邮件地址输入应该使用<code>&lt;input type=&quot;email&quot;&gt;</code>。</p></li><li><p><code>&quot;url&quot;</code><br>为网址输入优化的虚拟键盘，比如，“/”键会更加明显、历史记录访问等。表单里面的网址输入通常应该使用<code>&lt;input type=&quot;url&quot;&gt;</code>。</p></li></ul><p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="ExEyQdr" data-user="ly023" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/ExEyQdr" target="_blank" rel="noopener">  Untitled</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h2 id="虚拟键盘enterkeyhint属性"><a href="#虚拟键盘enterkeyhint属性" class="headerlink" title="虚拟键盘enterkeyhint属性"></a>虚拟键盘<code>enterkeyhint</code>属性</h2><p>设置虚拟键盘<code>Enter</code>键的显示内容，只影响按钮的显示，不影响交互。</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/enterkeyhint" target="_blank" rel="noopener">MDN enterkeyhint</a></p><p>兼容性：<a href="https://caniuse.com/mdn-api_htmlelement_enterkeyhint" target="_blank" rel="noopener">HTMLElement API: enterKeyHint</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">enterkeyhint</span>=<span class="string">"done"</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>enterkeyhint</code>设置虚拟键盘<code>Enter</code>回车键的显示：</p><ul><li>enter：回车，多出现在<code>&lt;textarea&gt;</code>文本域等需要多行输入的场景中</li><li>done：完成，表示没有更多内容输入，输入结束</li><li>go：前往，把用户带到他们输入的文本的目标处</li><li>next：下一项，通常会移动到下一个输入项那里</li><li>previous，上一个，通常会移动到上一个输入项那里</li><li>search：搜索，通常用在搜索行为中</li><li>send：发送，通常用在文本信息的发送上</li></ul><p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="vYRNaxr" data-user="ly023" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/vYRNaxr" target="_blank" rel="noopener">  Using the enterkeyhint Attribute</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h2 id="autocapitalize-quot-off-quot-关闭虚拟键盘首字母大写"><a href="#autocapitalize-quot-off-quot-关闭虚拟键盘首字母大写" class="headerlink" title="autocapitalize=&quot;off&quot;关闭虚拟键盘首字母大写"></a><code>autocapitalize=&quot;off&quot;</code>关闭虚拟键盘首字母大写</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">autocapitalize</span>=<span class="string">"off"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>还可以在<code>form</code>标签上设置该属性，让每个表单项都继承<code>autocapitalize</code>的设置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form autocapitalize=&quot;off&quot;&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; placeholder=&quot;继承 form 的设置&quot;&gt;</span><br><span class="line">  &lt;textarea&gt;&lt;/textarea&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p><code>autocapitalize</code>取值：</p><ul><li><p><code>none</code>或<code>off</code>：所有字母小写</p></li><li><p><code>words</code>：每个单词的开头字母会自动大写</p></li><li><p><code>characters</code>：所有字母大写</p></li><li><p><code>sentences</code>：每句开头字母自动大写</p></li></ul><h2 id="autocorrect-”off”关闭自动纠错功能"><a href="#autocorrect-”off”关闭自动纠错功能" class="headerlink" title="autocorrect=”off”关闭自动纠错功能"></a>autocorrect=”off”关闭自动纠错功能</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">autocorrect</span>=<span class="string">"off"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>自动纠错功能会悄悄篡改原本的输入内容，用户很难注意到。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录移动端开发文本输入框常用的HTML属性。&lt;/p&gt;</summary>
    
    
    
    <category term="项目实践" scheme="http://yoursite.com/categories/项目实践/"/>
    
    
    <category term="移动端" scheme="http://yoursite.com/tags/移动端/"/>
    
  </entry>
  
  <entry>
    <title>奇怪的CSS问题</title>
    <link href="http://yoursite.com/2022/03/20/CSS-%E5%A5%87%E6%80%AA%E7%9A%84CSS%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2022/03/20/CSS-%E5%A5%87%E6%80%AA%E7%9A%84CSS%E9%97%AE%E9%A2%98/</id>
    <published>2022-03-20T04:53:09.303Z</published>
    <updated>2022-08-14T14:42:15.776Z</updated>
    
    <content type="html"><![CDATA[<p>记录开发中遇到的第一眼摸不着头脑的CSS问题。</p><ul><li>input设置斜体字体导致边缘字符被截断</li></ul><a id="more"></a><h2 id="input设置斜体字体导致边缘字符被截断"><a href="#input设置斜体字体导致边缘字符被截断" class="headerlink" title="input设置斜体字体导致边缘字符被截断"></a>input设置斜体字体导致边缘字符被截断</h2><p><img src="/images/font.png" alt="demo"></p><p>无论为<code>input</code>设置多大的<code>padding</code>都无法解决问题。</p><p>解决方法：<code>input</code>设置<code>text-indent</code>属性</p><p>参考：<a href="https://aiocollective.com/blog/font-with-italic-style-cut-off-on-edges-in-input/" target="_blank" rel="noopener">font with italic style cut off on edges in input</a></p><h2 id="inline-box-设置斜体字体导致边缘字符被截断"><a href="#inline-box-设置斜体字体导致边缘字符被截断" class="headerlink" title="inline box 设置斜体字体导致边缘字符被截断"></a>inline box 设置斜体字体导致边缘字符被截断</h2><p>content: “”;<br>padding: 2px;</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;记录开发中遇到的第一眼摸不着头脑的CSS问题。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;input设置斜体字体导致边缘字符被截断&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
    <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>实现Sticky Footer布局</title>
    <link href="http://yoursite.com/2021/11/23/CSS-Sticky%20Footer/"/>
    <id>http://yoursite.com/2021/11/23/CSS-Sticky%20Footer/</id>
    <published>2021-11-23T02:11:14.000Z</published>
    <updated>2021-11-29T05:44:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><code>Sticky Footer</code>：页脚Footer永远固定在页面的底部。页面的内容不够时页脚固定在视窗底部，页面内容足够长时页脚紧贴在内容后面。</p><a id="more"></a><h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>Header<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span>Footer<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.content</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="420" data-default-tab="css,result" data-slug-hash="xxLNgQe" data-user="ly023" style="height: 420px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/xxLNgQe" target="_blank" rel="noopener">  sticky footer粘性页脚实现 - flex</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="position-sticky"><a href="#position-sticky" class="headerlink" title="position sticky"></a>position sticky</h3><p><a href="https://caniuse.com/css-sticky" target="_blank" rel="noopener">CSS position:sticky 兼容性</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span>Header<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span>Footer<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: sticky;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">100vh</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="380" data-default-tab="css,result" data-slug-hash="gOxJmvX" data-user="ly023" style="height: 380px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/gOxJmvX" target="_blank" rel="noopener">  sticky footer粘性页脚实现 - position sticky</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;code&gt;Sticky Footer&lt;/code&gt;：页脚Footer永远固定在页面的底部。页面的内容不够时页脚固定在视窗底部，页面内容足够长时页脚紧贴在内容后面。&lt;/p&gt;</summary>
    
    
    
    <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
    <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>Html Email</title>
    <link href="http://yoursite.com/2021/09/28/Html%20Email/"/>
    <id>http://yoursite.com/2021/09/28/Html%20Email/</id>
    <published>2021-09-28T06:26:48.000Z</published>
    <updated>2021-10-09T03:45:28.000Z</updated>
    
    <content type="html"><![CDATA[<p><code>HTML Email</code>兼容问题与解决方案。</p><a id="more"></a><p><a href="https://en.wikipedia.org/wiki/HTML_email" target="_blank" rel="noopener">HTML Email</a>能否正常显示，完全取决于邮件客户端。大多数的邮件客户端会过滤HTML设置，让邮件面目全非。</p><h2 id="基本规则"><a href="#基本规则" class="headerlink" title="基本规则"></a>基本规则</h2><h3 id="尽量使用table布局"><a href="#尽量使用table布局" class="headerlink" title="尽量使用table布局"></a>尽量使用table布局</h3><p>目前多数邮件客户端不支持<code>HTML5</code>与<code>CSS3</code>，部分客户端不支持<a href="https://www.caniemail.com/features/css-float/" target="_blank" rel="noopener">float</a>属性，尽量使用<a href="https://www.caniemail.com/features/html-table/" target="_blank" rel="noopener">table</a>布局，尽量使用<code>span</code>/<code>img</code>/<code>a</code>/<code>div</code>/<code>p</code>标签。</p><p>外层table用来设置背景，内层嵌套一个table用来展示内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">cellpadding</span>=<span class="string">"0"</span> <span class="attr">cellspacing</span>=<span class="string">"0"</span> <span class="attr">width</span>=<span class="string">"100%"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">bgcolor</span>=<span class="string">"#ffffff"</span> <span class="attr">cellpadding</span>=<span class="string">"0"</span> <span class="attr">cellspacing</span>=<span class="string">"0"</span> <span class="attr">width</span>=<span class="string">"640"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>内层table需要定一个宽度，或者设置最大宽度<code>max-width</code>，防止超过客户端的显示宽度。邮件内容有几个部分，就在内层table分几个<code>tr</code>。</p><h3 id="尽量将内容写到body内，尽量使用内联样式"><a href="#尽量将内容写到body内，尽量使用内联样式" class="headerlink" title="尽量将内容写到body内，尽量使用内联样式"></a>尽量将内容写到body内，尽量使用内联样式</h3><p>有些邮件客户端会把<code>DOCTYPE</code> / <code>html</code> / <code>head</code> / <code>body</code>标签删除，在可能的情况下尽量把内容写到<code>body</code>内，建议将全部内容放到<code>table</code>内。要确保即使<code>table</code>外的内容被删除，布局也能正常。</p><p>要适配手机客户端：<a href="https://www.caniemail.com/features/css-at-media/" target="_blank" rel="noopener">@meida</a>。</p><p>所有的CSS规则，最好都采用内联样式。</p><p>放置在网页头部的样式，可能会被客户端删除。放在<code>body</code>内的<code>style</code>标签，也可能被客户端删除。</p><p>查看邮件客户端是否支持<code>&lt;style&gt;</code>：<a href="https://www.caniemail.com/features/html-style/" target="_blank" rel="noopener">https://www.caniemail.com/features/html-style/</a></p><p>尽量不要采用CSS的简写形式，有些客户端不支持。</p><p>如果想表达<code>&lt;p style=&quot;margin: 16px 0;&quot;&gt;</code>，需要写成下面这样：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"margin-top: 16px; margin-right: 0;margin-bottom: 16px; margin-left: 0;"</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>color</code>尽可能不要使用简写：</p><p><code>color: #999;</code>需要写成<code>color: #999999;</code></p><h3 id="能用属性就不要用样式"><a href="#能用属性就不要用样式" class="headerlink" title="能用属性就不要用样式"></a>能用属性就不要用样式</h3><p>很多邮箱会对特定标签的属性做强制改造。</p><h4 id="图片设置宽高"><a href="#图片设置宽高" class="headerlink" title="图片设置宽高"></a>图片设置宽高</h4><p>比如在<code>OutLook</code>中，图片使用以下方式来设置宽高是无效的：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">"width: 10px; height: 10px;"</span> <span class="attr">src</span>=<span class="string">"xxx"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>正确的设置方法：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"10"</span> <span class="attr">height</span>=<span class="string">"10"</span> <span class="attr">src</span>=<span class="string">"xxx"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="加粗字体"><a href="#加粗字体" class="headerlink" title="加粗字体"></a>加粗字体</h4><p>对于加粗字体，建议使用<code>b</code>标签而不是设置<code>font-weight</code>。</p><h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><p>图片是唯一可以引用的外部资源。其他的外部资源一概不能引用。</p><p>有些客户端会给图片链接加上边框，要去除边框：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">src</span>=<span class="string">"xxx"</span> <span class="attr">alt</span>=<span class="string">"xxx"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>不少客户端默认不显示图片（比如<code>Gmail</code>），加载前需要用户的许可。所以要确保即使没有图片，主要内容也能被阅读，最好为图片加上<code>alt</code>属性说明图片的内容让用户选择是否下载它们。</p><h2 id="邮件客户端对HTML标签及CSS的支持情况"><a href="#邮件客户端对HTML标签及CSS的支持情况" class="headerlink" title="邮件客户端对HTML标签及CSS的支持情况"></a>邮件客户端对HTML标签及CSS的支持情况</h2><ul><li><p><a href="https://www.caniemail.com/" target="_blank" rel="noopener">caniemai</a></p></li><li><p><a href="https://www.campaignmonitor.com/css/" target="_blank" rel="noopener">campaignmonitor</a></p></li></ul><h2 id="从头开始构建一个-HTML-Email-模板"><a href="#从头开始构建一个-HTML-Email-模板" class="headerlink" title="从头开始构建一个 HTML Email 模板"></a>从头开始构建一个 HTML Email 模板</h2><p>可以参考这篇文章入门：</p><p><a href="https://webdesign.tutsplus.com/zh-hans/articles/build-an-html-email-template-from-scratch--webdesign-12770" target="_blank" rel="noopener">从头开始构建一个 HTML Email 模板</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><p><a href="http://www.ruanyifeng.com/blog/2013/06/html_email.html" target="_blank" rel="noopener">HTML Email 编写指南</a></p></li><li><p><a href="https://segmentfault.com/a/1190000008864116" target="_blank" rel="noopener">HTML 邮件兼容问题与解决方案</a></p></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;code&gt;HTML Email&lt;/code&gt;兼容问题与解决方案。&lt;/p&gt;</summary>
    
    
    
    <category term="项目实践" scheme="http://yoursite.com/categories/项目实践/"/>
    
    
    <category term="项目实践" scheme="http://yoursite.com/tags/项目实践/"/>
    
  </entry>
  
  <entry>
    <title>react-cropper结合Antd Upload实现图片裁剪并上传</title>
    <link href="http://yoursite.com/2021/08/13/react-cropper%E7%BB%93%E5%90%88Antd%20Upload%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E8%A3%81%E5%89%AA%E5%B9%B6%E4%B8%8A%E4%BC%A0/"/>
    <id>http://yoursite.com/2021/08/13/react-cropper%E7%BB%93%E5%90%88Antd%20Upload%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E8%A3%81%E5%89%AA%E5%B9%B6%E4%B8%8A%E4%BC%A0/</id>
    <published>2021-08-13T01:37:18.000Z</published>
    <updated>2021-09-02T06:21:42.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="cropper文档"><a href="#cropper文档" class="headerlink" title="cropper文档"></a>cropper文档</h2><p><a href="https://github.com/fengyuanchen/cropperjs" target="_blank" rel="noopener">cropperjs</a></p><p><a href="https://github.com/react-cropper/react-cropper" target="_blank" rel="noopener">react-cropper</a></p><a id="more"></a><p>cropperjs翻译文档：<a href="https://blog.csdn.net/weixin_38023551/article/details/78792400" target="_blank" rel="noopener">cropper.js 裁剪图片并上传（文档翻译+demo）</a></p><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-cropper</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Cropper <span class="keyword">from</span> <span class="string">'react-cropper'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'cropperjs/dist/cropper.css'</span></span><br></pre></td></tr></table></figure><h2 id="主要配置说明"><a href="#主要配置说明" class="headerlink" title="主要配置说明"></a>主要配置说明</h2><h3 id="viewMode-配置视图模式"><a href="#viewMode-配置视图模式" class="headerlink" title="viewMode 配置视图模式"></a><a href="https://github.com/fengyuanchen/cropperjs#viewmode" target="_blank" rel="noopener">viewMode</a> 配置视图模式</h3><ul><li>0：无限制</li><li>1：限制裁剪框不能超出图片的范围</li><li>2：限制裁剪框不能超出图片的范围，且图片填充模式为<strong>最长边填充</strong></li><li>3：限制裁剪框不能超出图片的范围，且图片填充模式为<strong>最短边填充</strong></li></ul><h3 id="dragMode-配置拖拽模式"><a href="#dragMode-配置拖拽模式" class="headerlink" title="dragMode 配置拖拽模式"></a><a href="https://github.com/fengyuanchen/cropperjs#dragmode" target="_blank" rel="noopener">dragMode</a> 配置拖拽模式</h3><ul><li>crop：拖拽形成新的裁剪框</li><li>move：拖拽只能移动图片</li><li>none：不做处理</li></ul><h2 id="主要方法说明"><a href="#主要方法说明" class="headerlink" title="主要方法说明"></a>主要方法说明</h2><h3 id="onInitialized-获取cropper实例"><a href="#onInitialized-获取cropper实例" class="headerlink" title="onInitialized 获取cropper实例"></a><a href="https://github.com/react-cropper/react-cropper#breaking-change-version--200" target="_blank" rel="noopener">onInitialized</a> 获取cropper实例</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onInitialized=&#123;(instance) =&gt; &#123;cropper.current = instance&#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="zoom-缩放事件"><a href="#zoom-缩放事件" class="headerlink" title="zoom 缩放事件"></a><a href="https://github.com/fengyuanchen/cropperjs#zoom" target="_blank" rel="noopener">zoom</a> 缩放事件</h3><p>在<code>zoom</code>监听事件中限制最大最小缩放比例：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> zoom = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; ratio, oldRatio &#125; = e.detail</span><br><span class="line">       <span class="comment">// zoom in</span></span><br><span class="line">        <span class="keyword">if</span> (ratio &gt; oldRatio) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ratio &gt; maxRatio) &#123;</span><br><span class="line">                e.preventDefault()  </span><br><span class="line">                cropper.current.zoomTo(maxRatio)</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="comment">// zoom out</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ratio &lt; oldRatio) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ratio &lt; minRatio) &#123;</span><br><span class="line">                e.preventDefault()</span><br><span class="line">                cropper.current.zoomTo(minRatio)</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="getCanvasData-获取裁剪的图片数据"><a href="#getCanvasData-获取裁剪的图片数据" class="headerlink" title="getCanvasData 获取裁剪的图片数据"></a><a href="https://github.com/fengyuanchen/cropperjs#getcanvasdata" target="_blank" rel="noopener">getCanvasData</a> 获取裁剪的图片数据</h3><h4 id="toBlob"><a href="#toBlob" class="headerlink" title="toBlob"></a>toBlob</h4><p><code>toBlob</code>第二个参数默认是<code>image/png</code>。</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getCroppedData = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cropper.current.getCroppedCanvas(&#123;</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">                imageSmoothingQuality: <span class="string">'high'</span>,</span><br><span class="line">            &#125;).toBlob(<span class="function">(<span class="params">blob</span>) =&gt;</span> &#123;</span><br><span class="line">                resolve(blob)</span><br><span class="line">            &#125;, <span class="string">'image/jpeg'</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            reject()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="toDataURL"><a href="#toDataURL" class="headerlink" title="toDataURL"></a>toDataURL</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cropper.current.getCroppedCanvas().toDataURL(<span class="string">'image/jpeg'</span>)</span><br></pre></td></tr></table></figure><h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;Cropper</span><br><span class="line">   src=&#123;image&#125; </span><br><span class="line">   dragMode=<span class="string">"move"</span></span><br><span class="line">   minCropBoxWidth=&#123;cropWidth&#125;</span><br><span class="line">   minCropBoxHeight=&#123;cropHeight&#125;</span><br><span class="line">   viewMode=&#123;<span class="number">3</span>&#125;</span><br><span class="line">   guides=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">   center=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">   checkOrientation=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">   background=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">   modal=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">   toggleDragModeOnDblclick=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">   cropBoxMovable=&#123;<span class="literal">false</span>&#125; <span class="comment">// 是否通过拖拽来移动剪裁框</span></span><br><span class="line">   cropBoxResizable=&#123;<span class="literal">false</span>&#125; <span class="comment">// 是否通过拖动来调整剪裁框的大小</span></span><br><span class="line">   onInitialized=&#123;initial&#125;</span><br><span class="line">   zoom=&#123;zoom&#125;</span><br><span class="line">   style=&#123;style&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure><h3 id="结合Antd-Upload裁剪并上传图片"><a href="#结合Antd-Upload裁剪并上传图片" class="headerlink" title="结合Antd Upload裁剪并上传图片"></a>结合Antd Upload裁剪并上传图片</h3><p><code>beforeUpload</code>返回<code>Promise</code>。在<code>beforeUpload</code>方法中，将得到的图片文件转成DataURL传给裁剪组件。设置定时器，每隔一段时间查询裁剪是否完成，若裁剪完成则<code>resolve(croppedFile)</code>。</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> beforeUpload = <span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        imageBlob.current = <span class="literal">null</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> reader = <span class="keyword">new</span> FileReader()</span><br><span class="line">        reader.readAsDataURL(file)</span><br><span class="line">        reader.onload = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">            setCropImage(e.target.result)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 定时器</span></span><br><span class="line">        timer.current = <span class="built_in">window</span>.setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 裁剪完成</span></span><br><span class="line">            <span class="keyword">if</span> (imageBlob.current) &#123;</span><br><span class="line">                <span class="built_in">window</span>.clearInterval(timer.current)</span><br><span class="line">                <span class="comment">// blob转file</span></span><br><span class="line">                <span class="keyword">const</span> croppedFile = <span class="keyword">new</span> File([avatarBlob.current], file.name, &#123;</span><br><span class="line">                    type: <span class="string">'image/jpeg'</span>,</span><br><span class="line">                    uid: file.uid,</span><br><span class="line">                    lastModified: <span class="built_in">Date</span>.now(),</span><br><span class="line">                &#125;)</span><br><span class="line">                resolve(croppedFile)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">100</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><iframe src="https://stackblitz.com/edit/react-af66qw?embed=1&file=src/App.js&hideExplorer=1&view=both" title="react image cropper demo" style="width:100%; height:600px; border:0; border-radius: 4px; overflow:hidden;"></iframe>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;cropper文档&quot;&gt;&lt;a href=&quot;#cropper文档&quot; class=&quot;headerlink&quot; title=&quot;cropper文档&quot;&gt;&lt;/a&gt;cropper文档&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/fengyuanchen/cropperjs&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;cropperjs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/react-cropper/react-cropper&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;react-cropper&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="React" scheme="http://yoursite.com/categories/React/"/>
    
    
    <category term="Plugin" scheme="http://yoursite.com/tags/Plugin/"/>
    
  </entry>
  
  <entry>
    <title>OSS + Ant Design Upload 网页直传</title>
    <link href="http://yoursite.com/2021/07/29/OSS%20+%20Ant%20Design%20Upload%20%E7%BD%91%E9%A1%B5%E7%9B%B4%E4%BC%A0/"/>
    <id>http://yoursite.com/2021/07/29/OSS%20+%20Ant%20Design%20Upload%20%E7%BD%91%E9%A1%B5%E7%9B%B4%E4%BC%A0/</id>
    <published>2021-07-29T09:10:16.000Z</published>
    <updated>2021-09-02T06:39:10.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><p><a href="https://help.aliyun.com/document_detail/32069.html?spm=a2c4g.11186623.6.1333.2b4349475kQkEE" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/32069.html?spm=a2c4g.11186623.6.1333.2b4349475kQkEE</a></p><a id="more"></a><h2 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h2><h3 id="ali-oss"><a href="#ali-oss" class="headerlink" title="ali-oss"></a>ali-oss</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add ali-oss</span><br></pre></td></tr></table></figure><h3 id="获取直传token"><a href="#获取直传token" class="headerlink" title="获取直传token"></a>获取直传token</h3><p>请求服务端接口获取直传token：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ossConfig = &#123;</span><br><span class="line">    accessKeyId: res.access_key_id,</span><br><span class="line">    accessKeySecret: res.access_key_secret,</span><br><span class="line">    stsToken: res.security_token,</span><br><span class="line">    region: res.region,</span><br><span class="line">    bucket: res.bucket,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为避免频繁请求token，将token存在localstorage中，比较token中的过期时间，判断过期后才重新获取。</p><h3 id="spark-md5获取文件的md5值"><a href="#spark-md5获取文件的md5值" class="headerlink" title="spark-md5获取文件的md5值"></a>spark-md5获取文件的md5值</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add spark-md5</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> readAsArrayBuffer = useCallback(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">           <span class="keyword">const</span> reader = <span class="keyword">new</span> FileReader()</span><br><span class="line">           reader.readAsArrayBuffer(data)</span><br><span class="line">           reader.onload = <span class="function">(<span class="params">evt</span>) =&gt;</span> &#123;</span><br><span class="line">               <span class="keyword">const</span> body = evt.target?.result</span><br><span class="line">               resolve(body)</span><br><span class="line">           &#125;</span><br><span class="line">           reader.onerror = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">               reject()</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;)</span><br><span class="line">   &#125;, [])</span><br><span class="line"></span><br><span class="line">   <span class="keyword">const</span> computeMd5 = useCallback(<span class="keyword">async</span> (file) =&gt; &#123;</span><br><span class="line">       <span class="keyword">const</span> Md5ChunkSize = <span class="number">2097152</span></span><br><span class="line">       <span class="keyword">let</span> currentChunk = <span class="number">0</span></span><br><span class="line">       <span class="keyword">const</span> chunks = <span class="built_in">Math</span>.ceil(file.size / Md5ChunkSize)</span><br><span class="line">       <span class="keyword">const</span> spark = <span class="keyword">new</span> SparkMD5.ArrayBuffer()</span><br><span class="line"></span><br><span class="line">       <span class="keyword">while</span> (currentChunk &lt; chunks) &#123;</span><br><span class="line">           <span class="keyword">const</span> start = currentChunk * Md5ChunkSize</span><br><span class="line">           <span class="keyword">const</span> end = start + Md5ChunkSize &gt;= file.size ? file.size : start + Md5ChunkSize</span><br><span class="line"></span><br><span class="line">           <span class="keyword">const</span> buffer = <span class="keyword">await</span> readAsArrayBuffer(file.slice(start, end))</span><br><span class="line">           spark.append(buffer)</span><br><span class="line">           currentChunk++</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> spark.end()</span><br><span class="line">   &#125;, [readAsArrayBuffer])</span><br></pre></td></tr></table></figure><h3 id="结合Ant-Design-Upload"><a href="#结合Ant-Design-Upload" class="headerlink" title="结合Ant Design Upload"></a>结合Ant Design Upload</h3><h4 id="OSSUpload组件"><a href="#OSSUpload组件" class="headerlink" title="OSSUpload组件"></a>OSSUpload组件</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">OSSUpload</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;children, ...restProps&#125; = props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> auth = useRef(<span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">const</span> authLoading = useRef(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> checkTokenExpired = useCallback(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!auth.current) &#123;</span><br><span class="line">            auth.current = getLocalToken()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> expiredTime = auth.current?.credentials?.expiration || <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> moment().isAfter(expiredTime)</span><br><span class="line">    &#125;, [])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> getAuth = useCallback(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="keyword">async</span> (resolve, reject) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (checkTokenExpired()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (authLoading.current) &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            auth.current = <span class="literal">null</span></span><br><span class="line">            authLoading.current = <span class="literal">true</span></span><br><span class="line">            removeLocalToken()</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> res = <span class="keyword">await</span> API.uploadAuth()</span><br><span class="line">                <span class="keyword">if</span> (!checkTokenExpired()) &#123;</span><br><span class="line">                    resolve()</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (res?.meta?.code === <span class="number">200</span>) &#123;</span><br><span class="line">                    auth.current = res.data</span><br><span class="line">                    setLocalToken(auth.current)</span><br><span class="line">                    resolve()</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    reject()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                reject()</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                authLoading.current = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resolve(auth.current)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;), [checkTokenExpired])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> getFilename = useCallback(<span class="function">(<span class="params">file, hash</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> idx = file.name.lastIndexOf(<span class="string">'.'</span>)</span><br><span class="line">        <span class="keyword">let</span> ext = <span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> (idx !== <span class="number">-1</span>) &#123;</span><br><span class="line">            ext = file.name.substr(idx)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;auth.current.dir&#125;</span><span class="subst">$&#123;hash&#125;</span><span class="subst">$&#123;ext&#125;</span>`</span></span><br><span class="line">    &#125;, [])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> beforeUpload = useCallback(<span class="keyword">async</span> (file, fileList) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;beforeUpload&#125; = props</span><br><span class="line">            <span class="keyword">if</span> (beforeUpload) &#123;</span><br><span class="line">                <span class="keyword">const</span> res = <span class="keyword">await</span> beforeUpload(file, fileList)</span><br><span class="line">                <span class="keyword">if</span> (res === <span class="literal">false</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> Upload.LIST_IGNORE</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> getAuth()</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="keyword">return</span> Upload.LIST_IGNORE</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, [getAuth, props])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> upload = useCallback(<span class="function">(<span class="params">option</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!auth.current) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> &#123;file, onProgress, onSuccess, onError&#125; = option</span><br><span class="line"></span><br><span class="line">        computeMd5(file)</span><br><span class="line">            .then(<span class="function">(<span class="params">hash</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> filename = getFilename(file, hash)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> AliClient = <span class="keyword">new</span> OSS(ossConfig)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                    AliClient</span><br><span class="line">                        .multipartUpload(</span><br><span class="line">                            filename,</span><br><span class="line">                            file,</span><br><span class="line">                            &#123;</span><br><span class="line">                                progress: <span class="keyword">async</span> (percent) =&gt; &#123;</span><br><span class="line">                                    onProgress(&#123;<span class="attr">percent</span>: percent * <span class="number">100</span>&#125;)</span><br><span class="line">                                &#125;,</span><br><span class="line">                            &#125;</span><br><span class="line">                        )</span><br><span class="line">                        .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">                            <span class="keyword">const</span> ossPath = result.res.requestUrls[<span class="number">0</span>].split(<span class="string">'?'</span>)[<span class="number">0</span>]</span><br><span class="line">                            <span class="keyword">const</span> url = ossPath.replace(<span class="regexp">/^http:\/\//i</span>, <span class="string">'https://'</span>)</span><br><span class="line">                            <span class="keyword">const</span> data = &#123;</span><br><span class="line">                                status: result?.res?.status,</span><br><span class="line">                                name: result?.name,</span><br><span class="line">                                url: url,</span><br><span class="line">                            &#125;</span><br><span class="line">                            onSuccess(data)</span><br><span class="line">                            resolve(result)</span><br><span class="line">                        &#125;)</span><br><span class="line">                        .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">                            onError(error)</span><br><span class="line">                            reject(error)</span><br><span class="line">                        &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(e)</span><br><span class="line">                onError(e)</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;, [computeMd5, getFilename])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> customRequest = useCallback(<span class="function">(<span class="params">option</span>) =&gt;</span> upload(option), [upload])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> uploadProps = &#123;</span><br><span class="line">        ...restProps,</span><br><span class="line">        beforeUpload: beforeUpload,</span><br><span class="line">        customRequest: props.customRequest ? props.customRequest : customRequest,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;Upload &#123;...uploadProps&#125;&gt;</span><br><span class="line">            &#123;children&#125;</span><br><span class="line">        &lt;<span class="regexp">/Upload&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;OSSUpload &#123;...uploadProps&#125;&gt;</span><br><span class="line">    &lt;div&gt;Change Avatar&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>OSSUpload&gt;</span><br></pre></td></tr></table></figure><h2 id="图片处理"><a href="#图片处理" class="headerlink" title="图片处理"></a>图片处理</h2><h3 id="图片缩放处理"><a href="#图片缩放处理" class="headerlink" title="图片缩放处理"></a>图片缩放处理</h3><p><a href="https://help.aliyun.com/document_detail/44688.html?spm=a2c4g.11186623.6.743.2ad549c061kTcJ" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/44688.html?spm=a2c4g.11186623.6.743.2ad549c061kTcJ</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;文档&quot;&gt;&lt;a href=&quot;#文档&quot; class=&quot;headerlink&quot; title=&quot;文档&quot;&gt;&lt;/a&gt;文档&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://help.aliyun.com/document_detail/32069.html?spm=a2c4g.11186623.6.1333.2b4349475kQkEE&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://help.aliyun.com/document_detail/32069.html?spm=a2c4g.11186623.6.1333.2b4349475kQkEE&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="文件上传与下载" scheme="http://yoursite.com/categories/文件上传与下载/"/>
    
    
    <category term="文件上传" scheme="http://yoursite.com/tags/文件上传/"/>
    
  </entry>
  
  <entry>
    <title>腾讯地图JavaScript API获取经纬度</title>
    <link href="http://yoursite.com/2021/03/30/%E8%85%BE%E8%AE%AF%E5%9C%B0%E5%9B%BEJavaScript%20API%E8%8E%B7%E5%8F%96%E7%BB%8F%E7%BA%AC%E5%BA%A6/"/>
    <id>http://yoursite.com/2021/03/30/%E8%85%BE%E8%AE%AF%E5%9C%B0%E5%9B%BEJavaScript%20API%E8%8E%B7%E5%8F%96%E7%BB%8F%E7%BA%AC%E5%BA%A6/</id>
    <published>2021-03-30T00:37:38.000Z</published>
    <updated>2022-08-02T09:43:39.581Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsBasic" target="_blank" rel="noopener">腾讯位置服务 JavaScript API</a></p><a id="more"></a><h3 id="加载地图-API"><a href="#加载地图-API" class="headerlink" title="加载地图 API"></a>加载地图 API</h3><p><a href="https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsQuick" target="_blank" rel="noopener">https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsQuick</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script charset=<span class="string">"utf-8"</span> src=<span class="string">"https://map.qq.com/api/js?v=2.exp&amp;key=YOUR_KEY"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>其中，v参数是引用的版本号，目前腾讯地图提供两个版本，分别是v=1，v=2.exp，推荐使用2.exp，可以获得最新最快的支持。Key参数YOUR_KEY是<a href="https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsBasic#2" target="_blank" rel="noopener">Key鉴权</a>中申请的key。</p><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initMap</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> center = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.LatLng(DefaultLatitude, DefaultLongitude);</span><br><span class="line">  <span class="keyword">const</span> mapOptions = &#123;</span><br><span class="line">    zoom: <span class="number">12</span>,</span><br><span class="line">    mapTypeId: <span class="built_in">window</span>.qq.maps.MapTypeId.ROADMAP,</span><br><span class="line">    center: center</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  map = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.Map(mapEle, mapOptions);</span><br><span class="line">  marker = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.Marker(&#123;</span><br><span class="line">    position: center,</span><br><span class="line">    map: map</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="marker标记"><a href="#marker标记" class="headerlink" title="marker标记"></a>marker标记</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">marker = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.Marker(&#123;</span><br><span class="line">    position: center,</span><br><span class="line">    map: map，</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>清除标记：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearMarker</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (marker &amp;&amp; marker.getMap()) &#123;</span><br><span class="line">    marker.setMap(<span class="literal">null</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="添加地图点击事件"><a href="#添加地图点击事件" class="headerlink" title="添加地图点击事件"></a>添加地图点击事件</h3><p><a href="https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsEvent" target="_blank" rel="noopener">事件</a></p><p><a href="https://lbs.qq.com/webDemoCenter/javascriptV2/event/mapClick" target="_blank" rel="noopener">点击地图事件</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickMapListener</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  listener = <span class="built_in">window</span>.qq.maps.event.addListener(map, <span class="string">"click"</span>, (event) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 获取点击位置的地理坐标属性latLng</span></span><br><span class="line">    <span class="keyword">const</span> &#123; latLng &#125; = event;</span><br><span class="line">    clearMarker();</span><br><span class="line">    marker = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.Marker(&#123;</span><br><span class="line">      position: latLng,</span><br><span class="line">      map: map</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> lng = <span class="built_in">Number</span>(latLng.getLng());</span><br><span class="line">    <span class="keyword">const</span> lat = <span class="built_in">Number</span>(latLng.getLat());</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>移除事件：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.qq.maps.event.removeListener(listener)</span><br></pre></td></tr></table></figure><h3 id="修改地图中心点"><a href="#修改地图中心点" class="headerlink" title="修改地图中心点"></a>修改地图中心点</h3><p><a href="https://lbs.qq.com/webApi/javascriptGL/glGuide/glMap" target="_blank" rel="noopener">地图显示控制</a></p><blockquote><p>通过调用setCenter方法可对地图中心点进行修改</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> TMap.Map(<span class="string">'container'</span>, &#123; <span class="comment">//初始化地图</span></span><br><span class="line">    center: <span class="keyword">new</span> TMap.LatLng(<span class="number">39.984120</span>,<span class="number">116.307484</span>),  <span class="comment">//设置地图初始中心点</span></span><br><span class="line">    zoom:<span class="number">11</span>,   <span class="comment">//设置地图缩放级别</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//修改地图中心点</span></span><br><span class="line">map.setCenter(<span class="keyword">new</span> TMap.LatLng(lat,lng));</span><br></pre></td></tr></table></figure><h3 id="根据地址获取坐标"><a href="#根据地址获取坐标" class="headerlink" title="根据地址获取坐标"></a>根据地址获取坐标</h3><p><a href="https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsService" target="_blank" rel="noopener">地址解析 Geocoder</a></p><blockquote><p>地址解析类用于在地址和经纬度之间进行转换的服务</p></blockquote><p><a href="https://lbs.qq.com/javascript_v2/case-run.html#sample-geocoding-simple" target="_blank" rel="noopener">官方 demo</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCoordsFromAddress</span>(<span class="params">address</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!geocoder) &#123;</span><br><span class="line">    geocoder = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.Geocoder();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> trimAddress = address ? address.trim() : <span class="string">""</span>;</span><br><span class="line">  <span class="keyword">const</span> geoAddress = trimAddress || DefaultAddress;</span><br><span class="line">  geocoder.getLocation(geoAddress);</span><br><span class="line">  geocoder.setComplete(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; location &#125; = result.detail;</span><br><span class="line">    <span class="keyword">const</span> &#123; lng, lat &#125; = location;</span><br><span class="line">    <span class="comment">// console.log(lng, lat)</span></span><br><span class="line">    map.setCenter(location);</span><br><span class="line">    clearMarker();</span><br><span class="line">    marker = <span class="keyword">new</span> <span class="built_in">window</span>.qq.maps.Marker(&#123;</span><br><span class="line">      map: map,</span><br><span class="line">      position: location</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">  &#125;);</span><br><span class="line">  geocoder.setError(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="隐藏控件"><a href="#隐藏控件" class="headerlink" title="隐藏控件"></a>隐藏控件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapOptions = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    disableDefaultUI: <span class="literal">true</span>, <span class="comment">// 隐藏所有控件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p class="codepen" data-height="500" data-theme-id="dark" data-default-tab="js,result" data-user="ly023" data-slug-hash="qBRRKXZ" style="height: 500px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="腾讯地图JavaScriptAPI">  <span>See the Pen <a href="https://codepen.io/ly023/pen/qBRRKXZ" target="_blank" rel="noopener">  腾讯地图JavaScriptAPI</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://lbs.qq.com/webApi/javascriptV2/jsGuide/jsBasic&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;腾讯位置服务 JavaScript API&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="API" scheme="http://yoursite.com/categories/API/"/>
    
    
    <category term="地图" scheme="http://yoursite.com/tags/地图/"/>
    
  </entry>
  
  <entry>
    <title>前端模糊搜索</title>
    <link href="http://yoursite.com/2021/03/04/JS-%E5%89%8D%E7%AB%AF%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2/"/>
    <id>http://yoursite.com/2021/03/04/JS-%E5%89%8D%E7%AB%AF%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2/</id>
    <published>2021-03-04T09:59:16.000Z</published>
    <updated>2021-03-06T04:05:40.000Z</updated>
    
    <content type="html"><![CDATA[<p>前端模糊搜索实现。</p><a id="more"></a><h3 id="转义关键字"><a href="#转义关键字" class="headerlink" title="转义关键字"></a>转义关键字</h3><p>避免带有<code>()*</code>等特殊字符的字符串与正则冲突：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escapeRegExp</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/[.*+?^$&#123;&#125;()|[\]\\]/g</span>, <span class="string">'\\$&amp;'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="根据关键字生成匹配正则"><a href="#根据关键字生成匹配正则" class="headerlink" title="根据关键字生成匹配正则"></a>根据关键字生成匹配正则</h3><p>将关键字拆分成正则，<code>普通 =&gt; /(.*?)(普)(.*?)(通)(.*?)/i</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">keywordReg</span>(<span class="params">keyword</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> src = [<span class="string">"(.*?)"</span>];</span><br><span class="line">  <span class="keyword">const</span> ks = keyword.split(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (ks.length) &#123;</span><br><span class="line">    ks.forEach(<span class="function">(<span class="params">s</span>) =&gt;</span> &#123;</span><br><span class="line">      src.push(<span class="string">`(<span class="subst">$&#123;escapeRegExp(s)&#125;</span>)(.*?)`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  src = src.join(<span class="string">""</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">RegExp</span>(src, <span class="string">"i"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="找到最大匹配长度"><a href="#找到最大匹配长度" class="headerlink" title="找到最大匹配长度"></a>找到最大匹配长度</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findMaxMatch</span>(<span class="params">str, keyword</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> escapeKeyword = escapeRegExp(keyword)</span><br><span class="line">    <span class="keyword">let</span> max = <span class="number">0</span></span><br><span class="line">    str.replace(escapeKeyword, (s) =&gt; &#123;</span><br><span class="line">        <span class="comment">// 完全匹配，最大</span></span><br><span class="line">        <span class="keyword">if</span> (keyword === s) &#123;</span><br><span class="line">            max = <span class="built_in">Number</span>.MAX_SAFE_INTEGER</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s.length &gt; max) &#123;</span><br><span class="line">            <span class="comment">// 最小匹配长度</span></span><br><span class="line">            max = s.length</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> max</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fuzzySearch</span>(<span class="params">strs, keyword</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(strs) &amp;&amp; <span class="keyword">typeof</span> keyword === <span class="string">'string'</span> &amp;&amp; keyword.trim()) &#123;</span><br><span class="line">        <span class="comment">// 过滤前后空格</span></span><br><span class="line">        keyword = keyword.trim()</span><br><span class="line">        <span class="comment">// 根据关键字生成匹配正则</span></span><br><span class="line">        <span class="keyword">const</span> kr = keywordReg(keyword)</span><br><span class="line">        <span class="comment">// 存放匹配结果</span></span><br><span class="line">        <span class="keyword">let</span> result = []</span><br><span class="line">        strs.forEach(<span class="function">(<span class="params">s</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">typeof</span> s === <span class="string">'string'</span>)</span><br><span class="line">            <span class="keyword">if</span> (kr.test(s)) &#123;</span><br><span class="line">                result.push(s)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">       </span><br><span class="line">        <span class="comment">// 对匹配结果降序排序，匹配度高的在前</span></span><br><span class="line">        <span class="keyword">if</span>(result.length) &#123;</span><br><span class="line">            result = result.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> findMaxMatch(b, keyword) - findMaxMatch(a, keyword))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> strs = [<span class="string">"VIP1（默认）"</span>, <span class="string">"vip2"</span>, <span class="string">"vi普通用户"</span>, <span class="string">"会员用户"</span>];</span><br><span class="line"><span class="keyword">const</span> keyword = <span class="string">"  VIP "</span>;</span><br><span class="line"><span class="keyword">const</span> resultStrs = fuzzySearch(strs, keyword);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ["VIP1（默认）", "vip2"]</span></span><br></pre></td></tr></table></figure><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="js" data-user="ly023" data-slug-hash="XWNYLOG" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="前端模糊查询">  <span>See the Pen <a href="https://codepen.io/ly023/pen/XWNYLOG" target="_blank" rel="noopener">  前端模糊查询</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://developpaper.com/fuzzy-search-on-the-front-end/" target="_blank" rel="noopener">https://developpaper.com/fuzzy-search-on-the-front-end/</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;前端模糊搜索实现。&lt;/p&gt;</summary>
    
    
    
    <category term="JS" scheme="http://yoursite.com/categories/JS/"/>
    
    
    <category term="JS" scheme="http://yoursite.com/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>HTML技巧</title>
    <link href="http://yoursite.com/2021/02/24/HTML-HTML%E6%8A%80%E5%B7%A7/"/>
    <id>http://yoursite.com/2021/02/24/HTML-HTML%E6%8A%80%E5%B7%A7/</id>
    <published>2021-02-24T00:35:34.000Z</published>
    <updated>2022-08-20T06:36:35.129Z</updated>
    
    <content type="html"><![CDATA[<p>一些实用的HTML技巧。</p><a id="more"></a><h3 id="更新网站图标"><a href="#更新网站图标" class="headerlink" title="更新网站图标"></a>更新网站图标</h3><p>通过在Favicon文件名中添加<code>?v=2</code>来强制浏览器下载新图标。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">href</span>=<span class="string">"/favicon.ico?v=2"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="mark标签-文字高亮"><a href="#mark标签-文字高亮" class="headerlink" title="mark标签 文字高亮"></a>mark标签 文字高亮</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">mark</span>&gt;</span>1905年6月9日<span class="tag">&lt;/<span class="name">mark</span>&gt;</span>，设想人长生不死。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="YzQzaqO" data-user="ly023" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/YzQzaqO" target="_blank" rel="noopener">  mark标签</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="图片懒加载-loading-”lazy”"><a href="#图片懒加载-loading-”lazy”" class="headerlink" title="图片懒加载 loading=”lazy”"></a>图片懒加载 loading=”lazy”</h3><p>兼容性：<a href="https://caniuse.com/loading-lazy-attr" target="_blank" rel="noopener">Lazy loading via attribute for images &amp; iframes</a></p><p>不考虑兼容性的情况下，可以通过为图片添加<code>loading=&quot;lazy&quot;</code>属性来实现图片懒加载：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"xxx.png"</span> <span class="attr">loading</span>=<span class="string">"lazy"</span> <span class="attr">alt</span>=<span class="string">"lazy"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="html,result" data-user="ly023" data-slug-hash="ExNbeMr" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="html技巧-图片懒加载-loading=&amp;quot;lazy&amp;quot;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/ExNbeMr" target="_blank" rel="noopener">  html技巧-图片懒加载-loading=&quot;lazy&quot;</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="Picture标签"><a href="#Picture标签" class="headerlink" title="Picture标签"></a>Picture标签</h3><p>HTML提供了<code>&lt;picture&gt;</code>标签，允许我们添加多个图片资源，并且根据不同的分辨率需求来展示不同的图片：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">picture</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">media</span>=<span class="string">"(min-width:768px)"</span> <span class="attr">srcset</span>=<span class="string">"https://picsum.photos/id/1000/400/400"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">media</span>=<span class="string">"(min-width:495px)"</span> <span class="attr">srcset</span>=<span class="string">"https://picsum.photos/id/1000/200/200"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://picsum.photos/id/1000/600/600"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">picture</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="使用-webp格式缩小图像并提高网站性能"><a href="#使用-webp格式缩小图像并提高网站性能" class="headerlink" title="使用.webp格式缩小图像并提高网站性能"></a>使用.webp格式缩小图像并提高网站性能</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">picture</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- load .webp image if supported --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">srcset</span>=<span class="string">"logo.webp"</span> <span class="attr">type</span>=<span class="string">"image/webp"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">Fallback if `.webp` images or &lt;picture&gt; tag </span></span><br><span class="line"><span class="comment">not supported by the browser.</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"logo.png"</span> <span class="attr">alt</span>=<span class="string">"logo"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">picture</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="datalist-输入提示"><a href="#datalist-输入提示" class="headerlink" title="datalist 输入提示"></a>datalist 输入提示</h3><p>通过<code>&lt;datalist&gt;</code>标签实现下拉选择（注意，<code>&lt;datalist&gt;</code>标签的id属性需要和input元素的list属性一致）：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">list</span>=<span class="string">"staffs"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">datalist</span> <span class="attr">id</span>=<span class="string">"staffs"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"Michael"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"Jack"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"Tom"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">datalist</span>&gt;</span></span><br></pre></td></tr></table></figure><p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="gOLXBbg" data-user="ly023" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/gOLXBbg" target="_blank" rel="noopener">  html技巧-输入提示</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="Base-URL"><a href="#Base-URL" class="headerlink" title="Base URL"></a>Base URL</h3><p>当页面有大量的锚点跳转或者静态资源加载，并且这些链接在同一域名下时，可以通过<code>&lt;base&gt;</code>标签简化链接（<code>&lt;base&gt;</code>标签必须具有<code>href</code>和<code>target</code>属性）：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">"https://picsum.photos/"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"id/1/200/200"</span>&gt;</span> source1 <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"id/2/200/200"</span>&gt;</span> source2 <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="页面重定向（刷新）"><a href="#页面重定向（刷新）" class="headerlink" title="页面重定向（刷新）"></a>页面重定向（刷新）</h3><p>“5s后页面将跳转”，这个交互可以通过<code>&lt;meta&gt;</code>标签设置<code>http-equiv=&quot;refresh&quot;</code>来实现：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> <span class="attr">content</span>=<span class="string">"5; URL='https://google.com' /&gt;</span></span></span><br></pre></td></tr></table></figure><p>这里<code>content</code>属性指定了重定向发生的秒数。使用这种类型的重定向其实并不是那么的优雅，往往会显得很突兀。因此，最好在某些特殊的情况下使用它，比如在长时间用户不活动之后再重定向到目标页面。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;一些实用的HTML技巧。&lt;/p&gt;</summary>
    
    
    
    <category term="HTML" scheme="http://yoursite.com/categories/HTML/"/>
    
    
    <category term="HTML" scheme="http://yoursite.com/tags/HTML/"/>
    
  </entry>
  
  <entry>
    <title>CSS新特性</title>
    <link href="http://yoursite.com/2021/02/04/CSS-CSS%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    <id>http://yoursite.com/2021/02/04/CSS-CSS%E6%96%B0%E7%89%B9%E6%80%A7/</id>
    <published>2021-02-04T00:55:26.000Z</published>
    <updated>2021-11-09T07:09:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>CSS新特性</p><a id="more"></a><h2 id="设置容器的长宽比-aspect-ratio"><a href="#设置容器的长宽比-aspect-ratio" class="headerlink" title="设置容器的长宽比 aspect-ratio"></a>设置容器的长宽比 aspect-ratio</h2><p><a href="https://www.w3.org/TR/css-sizing-4/#aspect-ratio" target="_blank" rel="noopener">CSS Box Sizing Module Level 4 specification</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/aspect-ratio" target="_blank" rel="noopener">MDN aspect-ratio</a></p><p>兼容性：<a href="https://caniuse.com/mdn-css_properties_aspect-ratio" target="_blank" rel="noopener">CSS property: aspect-ratio</a>（Chrome 88）</p><!-- more --><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aspect-ratio: auto || &lt;ratio&gt;;</span><br></pre></td></tr></table></figure><p>默认值为auto，或接受ratio作为值，其中<code>ratio = width / height</code></p><h3 id="在一些情况下aspect-ratio将被忽略"><a href="#在一些情况下aspect-ratio将被忽略" class="headerlink" title="在一些情况下aspect-ratio将被忽略"></a>在一些情况下aspect-ratio将被忽略</h3><h4 id="当元素同时声明了width和height时"><a href="#当元素同时声明了width和height时" class="headerlink" title="当元素同时声明了width和height时"></a>当元素同时声明了<code>width</code>和<code>height</code>时</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">aspect-ratio</span>: <span class="number">2</span> / <span class="number">1</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="当内容超出比例时"><a href="#当内容超出比例时" class="headerlink" title="当内容超出比例时"></a>当内容超出比例时</h4><p>内容过多撑开元素导致元素的尺寸改变，就没有长宽比了。</p><p>设置<code>overflow-y: auto</code>，元素保持长宽比显示滚动条：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">aspect-ratio</span>: <span class="number">2</span> / <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="跨浏览器兼容-padding-top"><a href="#跨浏览器兼容-padding-top" class="headerlink" title="跨浏览器兼容 padding-top"></a>跨浏览器兼容 padding-top</h3><p>要求子元素相对于父元素绝对定位，父元素padding-top设置为高/宽百分比：</p><ul><li><p>1:1 aspect ratio = 1 / 1 = 1 = padding-top: 100%</p></li><li><p>4:3 aspect ratio = 3 / 4 = 0.75 = padding-top: 75%</p></li><li><p>16:9 aspect ratio = 9 / 16 = 0.5625 = padding-top: 56.25%</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"cover"</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">alt</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="comment">/*   padding-top: 56.25%; */</span></span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">75%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cover</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="420" data-default-tab="css,result" data-slug-hash="wvdxVXY" data-user="ly023" style="height: 420px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/wvdxVXY" target="_blank" rel="noopener">  aspect-ratio hack</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://web.dev/aspect-ratio/" target="_blank" rel="noopener">https://web.dev/aspect-ratio/</a></p><h2 id="focus-visible"><a href="#focus-visible" class="headerlink" title="focus-visible"></a>focus-visible</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/:focus-visible" target="_blank" rel="noopener">MDN :focus-visible</a></p><p><a href="https://caniuse.com/css-focus-visible" target="_blank" rel="noopener">兼容性</a></p><p>希望鼠标点击button的时候不显示outline焦点轮廓，而TAB键访问时保留outline轮廓：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.button</span><span class="selector-pseudo">:focus</span><span class="selector-pseudo">:not(</span><span class="selector-pseudo">:focus-visible)</span> &#123;</span><br><span class="line">    <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.button</span><span class="selector-pseudo">:focus-visible</span> &#123;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">3px</span> solid <span class="number">#ff4323</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="css,result" data-user="ly023" data-slug-hash="QWGqGLV" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title=":focus-visible">  <span>See the Pen <a href="https://codepen.io/ly023/pen/QWGqGLV" target="_blank" rel="noopener">  :focus-visible</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h2 id="box-decoration-break"><a href="#box-decoration-break" class="headerlink" title="box-decoration-break"></a>box-decoration-break</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/box-decoration-break" target="_blank" rel="noopener">MDN box-decoration-break</a></p><p><a href="https://www.w3.org/TR/css-break-3/#break-decoration" target="_blank" rel="noopener">W3C Fragmented Borders and Backgrounds: the box-decoration-break property</a></p><p>兼容性：<a href="https://caniuse.com/css-boxdecorationbreak" target="_blank" rel="noopener">CSS box-decoration-break</a>（Firefox完全支持）</p><blockquote><p>box-decoration-break 属性用来定义当元素跨多行、多列或多页时，元素的片段应如何呈现。</p></blockquote><p>通常作用于内联元素。</p><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><ul><li>box-decoration-break: slice; （默认值）</li><li>box-decoration-break: clone;</li></ul><h3 id="box-decoration-break-clone"><a href="#box-decoration-break-clone" class="headerlink" title="box-decoration-break: clone"></a>box-decoration-break: clone</h3><p>使用了<code>box-decoration-break: clone</code>的内联元素，如果存在折行，那么每一行都将拥有原本单行的所有样式。</p><p><code>box-decoration-break: clone</code>只会作用于以下样式：</p><ul><li>background</li><li>border</li><li>border-image</li><li>box-shadow</li><li>border-radius</li><li>clip-path</li><li>margin</li><li>padding</li></ul><p>Firefox下查看：</p><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="html,result" data-user="ly023" data-slug-hash="YzpoYYV" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="内联元素换行 - box-decoration-break: clone">  <span>See the Pen <a href="https://codepen.io/ly023/pen/YzpoYYV" target="_blank" rel="noopener">  内联元素换行 - box-decoration-break: clone</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h2 id="flex-gap"><a href="#flex-gap" class="headerlink" title="flex gap"></a>flex gap</h2><p>在flex布局中使用gap属性，控制水平和竖直方向上item之间的距离。</p><p>兼容性：<a href="https://caniuse.com/flexbox-gap" target="_blank" rel="noopener">Chrome 84及以上</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="html,result" data-user="ly023" data-slug-hash="wvJoMbV" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="flex gap">  <span>See the Pen <a href="https://codepen.io/ly023/pen/wvJoMbV" target="_blank" rel="noopener">  flex gap</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h2 id="marker伪元素"><a href="#marker伪元素" class="headerlink" title="::marker伪元素"></a>::marker伪元素</h2><p><code>::marker</code>伪元素用于自定义有序列表<code>&lt;ol&gt;</code>和无序列表<code>&lt;ul&gt;</code>中的<code>&lt;li&gt;</code>以及设置了<code>display: list-item</code>的元素的项目标记符号。与<code>list-style-type</code>和<code>list-style-image</code>不同的是，<code>::marker</code>可以自定义<code>color</code>、<code>font-size</code>等样式。</p><p><a href="https://www.w3.org/TR/css-lists-3/#marker-pseudo" target="_blank" rel="noopener">W3C The ::marker Pseudo-Element</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/::marker" target="_blank" rel="noopener">MDN ::marker</a></p><p>兼容性： <a href="https://www.caniuse.com/mdn-css_selectors_marker_animation_and_transition_support" target="_blank" rel="noopener">CSS selector: ::marker: Animation and transition support</a></p><p>IE不支持，Chrome 86开始才支持。</p><h3 id="使用-marker定义项目符号"><a href="#使用-marker定义项目符号" class="headerlink" title="使用::marker定义项目符号"></a>使用::marker定义项目符号</h3><p><code>::marker</code>仅适用于列表项，其他元素要想使用<code>::marker</code>，需设置<code>display: list-item</code>。</p><iframe height="348" style="width: 100%;" scrolling="no" title="::marker" src="https://codepen.io/ly023/embed/jOrqEYJ?height=348&theme-id=dark&default-tab=css,result" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">  See the Pen <a href="https://codepen.io/ly023/pen/jOrqEYJ" target="_blank" rel="noopener">::marker</a> by ly023  (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="目前允许的属性值"><a href="#目前允许的属性值" class="headerlink" title="目前允许的属性值"></a>目前允许的属性值</h3><ul><li><p>所有的<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Fonts" target="_blank" rel="noopener">字体属性</a></p></li><li><p>color</p></li><li><p>content</p></li><li><p><a href="https://www.w3.org/TR/css-writing-modes-4/#propdef-text-combine-upright" target="_blank" rel="noopener">text-combine-upright</a></p></li><li><p>direction</p></li><li><p>unicode-bidi</p></li><li><p>white-space</p></li><li><p>所有的<a href="[CSS-ANIMATIONS-1]">animation</a>和<a href="https://www.w3.org/TR/css-lists-3/#biblio-css-transitions-1" target="_blank" rel="noopener">transition</a>属性</p></li></ul><h3 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h3><ul><li><p><a href="https://web.dev/css-marker-pseudo-element/" target="_blank" rel="noopener">https://web.dev/css-marker-pseudo-element/</a></p></li><li><p>box-decoration-break: <a href="https://www.zhangxinxu.com/wordpress/2019/01/css-css3-box-decoration-break/" target="_blank" rel="noopener">https://www.zhangxinxu.com/wordpress/2019/01/css-css3-box-decoration-break/</a></p></li></ul><h2 id="accent-color"><a href="#accent-color" class="headerlink" title="accent-color"></a>accent-color</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/accent-color" target="_blank" rel="noopener">MDN accent-color</a></p><p>自定义表单控件主题色。</p><p><a href="https://caniuse.com/mdn-css_properties_accent-color" target="_blank" rel="noopener">兼容性</a></p><p class="codepen" data-height="353" data-default-tab="css,result" data-slug-hash="NWvWKpx" data-user="ly023" style="height: 353px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">  <span>See the Pen <a href="https://codepen.io/ly023/pen/NWvWKpx" target="_blank" rel="noopener">  CSS accent-color自定义表单主题色</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h2 id="any-link"><a href="#any-link" class="headerlink" title=":any-link"></a>:any-link</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/:any-link" target="_blank" rel="noopener">MDN :any-link</a></p><blockquote><p>它会匹配每一个有 href 属性的 <a>、<area> 或 <link> 元素</a></p></blockquote><p><a href="https://www.caniuse.com/css-any-link" target="_blank" rel="noopener">兼容性</a></p><p><code>:any-link</code>优先级大于a选择器，即使a选择器被放在较后的位置。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:any-link</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="html,result" data-user="ly023" data-slug-hash="mdRYPow" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="CSS :any-link selector">  <span>See the Pen <a href="https://codepen.io/ly023/pen/mdRYPow" target="_blank" rel="noopener">  CSS :any-link selector</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;CSS新特性&lt;/p&gt;</summary>
    
    
    
    <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
    <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>flex布局最后一行左对齐</title>
    <link href="http://yoursite.com/2020/12/22/CSS-flex%E5%B8%83%E5%B1%80%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E5%B7%A6%E5%AF%B9%E9%BD%90/"/>
    <id>http://yoursite.com/2020/12/22/CSS-flex%E5%B8%83%E5%B1%80%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E5%B7%A6%E5%AF%B9%E9%BD%90/</id>
    <published>2020-12-22T01:57:12.000Z</published>
    <updated>2021-01-10T02:56:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>flex布局最后一行左对齐的几种方法。</p><a id="more"></a><h3 id="列数不固定"><a href="#列数不固定" class="headerlink" title="列数不固定"></a>列数不固定</h3><h4 id="添加空白标签占位"><a href="#添加空白标签占位" class="headerlink" title="添加空白标签占位"></a>添加空白标签占位</h4><p>添加足够的空白标签填充占位，具体数量由最大列数决定。例如这个布局最多10列，就需要使用10个空白标签占位。占位标签的<code>width</code>和<code>margin</code>应与item相同。</p><p>缺点：污染html</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--  使用足够多的标签占位  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">i</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 设置和item相同的width和margin</span></span><br><span class="line">  &gt; <span class="selector-tag">i</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">120px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="320" data-theme-id="dark" data-default-tab="css,result" data-user="ly023" data-slug-hash="NWRzQOv" style="height: 320px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="flex-align last row to the left ">  <span>See the Pen <a href="https://codepen.io/ly023/pen/NWRzQOv" target="_blank" rel="noopener">  flex-align last row to the left </a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h4 id="改成Grid布局"><a href="#改成Grid布局" class="headerlink" title="改成Grid布局"></a>改成Grid布局</h4><p><a href="https://www.caniuse.com/css-grid" target="_blank" rel="noopener">兼容性</a></p><p>不考虑兼容性问题，首选Grid布局。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.grid</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: repeat(auto-fill, <span class="number">120px</span>);</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">  <span class="attribute">grid-gap</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p class="codepen" data-height="320" data-theme-id="dark" data-default-tab="css,result" data-user="ly023" data-slug-hash="jOMpNme" style="height: 320px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="flex布局最后一行左对齐-使用grid布局">  <span>See the Pen <a href="https://codepen.io/ly023/pen/jOMpNme" target="_blank" rel="noopener">  flex布局最后一行左对齐-使用grid布局</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;flex布局最后一行左对齐的几种方法。&lt;/p&gt;</summary>
    
    
    
    <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
    <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>移动端开发-监听虚拟键盘弹出收起</title>
    <link href="http://yoursite.com/2020/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AF-%E7%9B%91%E5%90%AC%E8%99%9A%E6%8B%9F%E9%94%AE%E7%9B%98%E5%BC%B9%E5%87%BA%E6%94%B6%E8%B5%B7/"/>
    <id>http://yoursite.com/2020/12/07/%E7%A7%BB%E5%8A%A8%E7%AB%AF-%E7%9B%91%E5%90%AC%E8%99%9A%E6%8B%9F%E9%94%AE%E7%9B%98%E5%BC%B9%E5%87%BA%E6%94%B6%E8%B5%B7/</id>
    <published>2020-12-07T11:08:28.000Z</published>
    <updated>2022-07-14T00:42:37.037Z</updated>
    
    <content type="html"><![CDATA[<p>移动端判断虚拟键盘弹出或收起</p><a id="more"></a><h3 id="iOS监听虚拟键盘弹出收起"><a href="#iOS监听虚拟键盘弹出收起" class="headerlink" title="iOS监听虚拟键盘弹出收起"></a>iOS监听虚拟键盘弹出收起</h3><p><code>focusin</code>/<code>focusout</code>事件早于<code>focus</code>/<code>blur</code>事件触发。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 弹出</span></span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'focusin'</span>, focusin)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 收起</span></span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'focusout'</span>, focusout)</span><br></pre></td></tr></table></figure><h3 id="Android监听虚拟键盘弹出收起"><a href="#Android监听虚拟键盘弹出收起" class="headerlink" title="Android监听虚拟键盘弹出收起"></a>Android监听虚拟键盘弹出收起</h3><p>Android虚拟键盘弹出或收起时，会改变<code>window</code>的高度，因此通过监听<code>window</code>的<code>resize</code>事件判断状态：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> originHeight = <span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">reisze</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> resizeHeight = <span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (resizeHeight &lt; originHeight) &#123;</span><br><span class="line">        <span class="comment">// 键盘弹出</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 键盘收起</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'resize'</span>, reisze)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;移动端判断虚拟键盘弹出或收起&lt;/p&gt;</summary>
    
    
    
    <category term="项目实践" scheme="http://yoursite.com/categories/项目实践/"/>
    
    
    <category term="移动端" scheme="http://yoursite.com/tags/移动端/"/>
    
  </entry>
  
  <entry>
    <title>ECharts 5 配置</title>
    <link href="http://yoursite.com/2020/12/03/Plugin-ECharts%205/"/>
    <id>http://yoursite.com/2020/12/03/Plugin-ECharts%205/</id>
    <published>2020-12-03T07:42:56.000Z</published>
    <updated>2022-02-20T10:42:33.318Z</updated>
    
    <content type="html"><![CDATA[<p>整理了一些工作中常用的ECharts配置。</p><p><a href="https://echarts.apache.org/examples/zh/index.html" target="_blank" rel="noopener">examples</a></p><p><a href="https://gallery.echartsjs.com/explore.html#sort=rank~timeframe=all~author=all" target="_blank" rel="noopener">Echarts Gallery</a></p><p>在react中使用Echarts：<a href="https://github.com/hustcc/echarts-for-react" target="_blank" rel="noopener">echarts-for-react</a> </p><a id="more"></a><h3 id="5-0-0"><a href="#5-0-0" class="headerlink" title="5.0.0"></a>5.0.0</h3><p>Echarts 5.0.0更新日志：</p><p><a href="https://github.com/apache/incubator-echarts/releases" target="_blank" rel="noopener">https://github.com/apache/incubator-echarts/releases</a></p><h3 id="指定渲染器"><a href="#指定渲染器" class="headerlink" title="指定渲染器"></a>指定渲染器</h3><p><a href="https://echarts.apache.org/zh/tutorial.html#%E4%BD%BF%E7%94%A8%20Canvas%20%E6%88%96%E8%80%85%20SVG%20%E6%B8%B2%E6%9F%93" target="_blank" rel="noopener">官方文档：使用 Canvas 或者 SVG 渲染</a></p><p>默认使用Canvas渲染：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.chart = echarts.init(container, <span class="literal">null</span>, &#123;<span class="attr">renderer</span>: <span class="string">'canvas'</span>&#125;)</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="keyword">this</span>.chart = echarts.init(container)</span><br></pre></td></tr></table></figure><p>移动端推荐使用SVG渲染：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.chart = echarts.init(container, <span class="literal">null</span>, &#123;<span class="attr">renderer</span>: <span class="string">'svg'</span>&#125;)</span><br></pre></td></tr></table></figure><p>如果已经设置了<code>renderer: &#39;svg&#39;</code>，但是渲染出的仍然是canvas，检查一下是否引入了SVG渲染器模块:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> echarts <span class="keyword">from</span> <span class="string">'echarts/lib/echarts'</span></span><br><span class="line"><span class="comment">// 引入SVG渲染器模块</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'zrender/lib/svg/svg'</span></span><br></pre></td></tr></table></figure><h3 id="通用"><a href="#通用" class="headerlink" title="通用"></a>通用</h3><h4 id="设置渐变填充色"><a href="#设置渐变填充色" class="headerlink" title="设置渐变填充色"></a>设置渐变填充色</h4><p>配置文档：<a href="https://echarts.apache.org/zh/option.html#series-line.areaStyle.color" target="_blank" rel="noopener">https://echarts.apache.org/zh/option.html#series-line.areaStyle.color</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">color: &#123;</span><br><span class="line">    type: <span class="string">'linear'</span>, </span><br><span class="line">    <span class="comment">// 线性渐变，x y x2 y2 参数用于配置渐变色的起止位置, 依次对应右/下/左/上四个方位。</span></span><br><span class="line">    <span class="comment">// 0 0 0 1 代表渐变色从正上方开始。</span></span><br><span class="line">    <span class="comment">// 范围从 0 - 1，相当于在图形包围盒中的百分比，</span></span><br><span class="line">    <span class="comment">// 如果 globalCoord 为 `true`，则该四个值是绝对的像素位置</span></span><br><span class="line">    x: <span class="number">0</span>,</span><br><span class="line">    y: <span class="number">0</span>,</span><br><span class="line">    x2: <span class="number">0</span>,</span><br><span class="line">    y2: <span class="number">1</span>,</span><br><span class="line">    colorStops: [&#123;</span><br><span class="line">        offset: <span class="number">0</span>,</span><br><span class="line">        color: <span class="string">'#7EB2FB'</span> <span class="comment">// 0% 处的颜色</span></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        offset: <span class="number">1</span>,</span><br><span class="line">        color: <span class="string">'#487BF6'</span> <span class="comment">// 100% 处的颜色</span></span><br><span class="line">    &#125;],</span><br><span class="line">    globalCoord: <span class="literal">false</span> <span class="comment">// 缺省为 false</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="自定义tooltip"><a href="#自定义tooltip" class="headerlink" title="自定义tooltip"></a>自定义tooltip</h4><p>formatter: <a href="https://echarts.apache.org/zh/option.html#tooltip.formatter" target="_blank" rel="noopener">https://echarts.apache.org/zh/option.html#tooltip.formatter</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tooltip: &#123;</span><br><span class="line">    confine: <span class="literal">true</span>, <span class="comment">// 将 tooltip 框限制在图表的区域内 </span></span><br><span class="line">    formatter: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用富文本标签自定义样式"><a href="#使用富文本标签自定义样式" class="headerlink" title="使用富文本标签自定义样式"></a>使用富文本标签自定义样式</h4><p><a href="https://echarts.apache.org/zh/tutorial.html#%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A0%87%E7%AD%BE" target="_blank" rel="noopener">https://echarts.apache.org/zh/tutorial.html#%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A0%87%E7%AD%BE</a></p><h4 id="legend关闭图例选择"><a href="#legend关闭图例选择" class="headerlink" title="legend关闭图例选择"></a>legend关闭图例选择</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">legend: &#123;</span><br><span class="line">    selectedMode: <span class="literal">false</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="设置x、y轴颜色"><a href="#设置x、y轴颜色" class="headerlink" title="设置x、y轴颜色"></a>设置x、y轴颜色</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xAxis: &#123;</span><br><span class="line">    axisLine: &#123;</span><br><span class="line">        lineStyle: &#123;</span><br><span class="line">            color: <span class="string">'#0087ED'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="设置x、y轴分区域的背景颜色"><a href="#设置x、y轴分区域的背景颜色" class="headerlink" title="设置x、y轴分区域的背景颜色"></a>设置x、y轴分区域的背景颜色</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yAxis: &#123;</span><br><span class="line">    splitArea: &#123;</span><br><span class="line">        show: <span class="literal">true</span>,</span><br><span class="line">        areaStyle: &#123;</span><br><span class="line">            color: [</span><br><span class="line">                <span class="string">'rgba(123,19,19,0.3)'</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="强制x、y轴显示所有刻度标签"><a href="#强制x、y轴显示所有刻度标签" class="headerlink" title="强制x、y轴显示所有刻度标签"></a>强制x、y轴显示所有刻度标签</h4><p>默认会采用标签不重叠的策略间隔显示标签。设置<code>interval : 0</code>强制显示所有标签：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xAxis: &#123;</span><br><span class="line">    axisLabel: &#123;</span><br><span class="line">        interval: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">yAxis: &#123;</span><br><span class="line">    axisLabel: &#123;</span><br><span class="line">        interval: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="绘制额外的元素"><a href="#绘制额外的元素" class="headerlink" title="绘制额外的元素"></a>绘制额外的元素</h4><p><a href="https://echarts.apache.org/zh/option.html#graphic" target="_blank" rel="noopener">https://echarts.apache.org/zh/option.html#graphic</a></p><h3 id="标题居中"><a href="#标题居中" class="headerlink" title="标题居中"></a>标题居中</h3><p>使用<code>left: center</code>而不是<code>textAlign: center</code>。具体看<a href="https://github.com/apache/echarts/issues/4550" target="_blank" rel="noopener">issue：标题使用textAlign无法居中 #4550</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">        text: <span class="string">'标题标题'</span>,</span><br><span class="line">        left: <span class="string">'center'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="词云"><a href="#词云" class="headerlink" title="词云"></a>词云</h3><p><a href="https://github.com/ecomfe/echarts-wordcloud" target="_blank" rel="noopener">github echarts-wordcloud</a></p><h3 id="折线图"><a href="#折线图" class="headerlink" title="折线图"></a>折线图</h3><h4 id="拐点"><a href="#拐点" class="headerlink" title="拐点"></a>拐点</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">series: [&#123;</span><br><span class="line">    name: name,</span><br><span class="line">    type: <span class="string">'line'</span>,</span><br><span class="line">    symbol: <span class="string">'circle'</span>, <span class="comment">// 拐点类型，实心圆</span></span><br><span class="line">    symbolSize: <span class="number">8</span>, <span class="comment">// 拐点大小</span></span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><h4 id="平滑曲线"><a href="#平滑曲线" class="headerlink" title="平滑曲线"></a>平滑曲线</h4><p><a href="https://echarts.apache.org/zh/option.html#series-line.smooth" target="_blank" rel="noopener">series-line. smooth</a></p><blockquote><p>如果是<code>boolean</code>类型，则表示是否开启平滑处理。如果是<code>number</code>类型（取值范围 0 到 1），表示平滑程度，越小表示越接近折线段，反之则反。设为<code>true</code>时相当于设为<code>0.5</code>。</p></blockquote><h3 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h3><h4 id="设置最大宽度"><a href="#设置最大宽度" class="headerlink" title="设置最大宽度"></a>设置最大宽度</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">series: [</span><br><span class="line">   &#123;</span><br><span class="line">    barMaxWidth: <span class="number">100</span></span><br><span class="line">   &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="堆叠柱状图数据为0时label会堆叠"><a href="#堆叠柱状图数据为0时label会堆叠" class="headerlink" title="堆叠柱状图数据为0时label会堆叠"></a>堆叠柱状图数据为0时label会堆叠</h4><p>解决方法1：label设置formatter，为0时隐藏label：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">series: [&#123;</span><br><span class="line">    label: &#123;</span><br><span class="line">        show: <span class="literal">true</span>,</span><br><span class="line">        formatter: <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> params.value || <span class="string">''</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><p>解决方法2：将值设置为null隐藏该类目</p><p>注意：如果有设置tooltip，tooltip显示的值将会是<code>-</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatNum</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(num === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> num</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">series: [&#123;</span><br><span class="line">    data: [<span class="number">2</span>, formatNum(<span class="number">0</span>), <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, formatNum(<span class="number">0</span>)],</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><h3 id="双Y轴-折线图-柱状图"><a href="#双Y轴-折线图-柱状图" class="headerlink" title="双Y轴 折线图 + 柱状图"></a>双Y轴 折线图 + 柱状图</h3><p>Demo: <a href="https://www.makeapie.com/editor.html?c=x5zMgDYwEZ" target="_blank" rel="noopener">https://www.makeapie.com/editor.html?c=x5zMgDYwEZ</a></p><p>关键代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">legend: &#123;</span><br><span class="line">    data: [<span class="string">'频道数'</span>, <span class="string">'有效视频数'</span>],</span><br><span class="line">&#125;,</span><br><span class="line">xAxis: &#123;</span><br><span class="line">    type: <span class="string">'category'</span>,</span><br><span class="line">    name: <span class="string">'分类'</span>,</span><br><span class="line">    data: [],</span><br><span class="line">&#125;,</span><br><span class="line">yAxis: [</span><br><span class="line">    &#123;</span><br><span class="line">        type: <span class="string">'value'</span>, <span class="comment">// 左侧y轴</span></span><br><span class="line">        name: <span class="string">'频道数'</span>, </span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        type: <span class="string">'value'</span>, <span class="comment">// 右侧y轴</span></span><br><span class="line">        name: <span class="string">'有效视频数'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">],</span><br><span class="line">series: [</span><br><span class="line">    &#123;</span><br><span class="line">        type: <span class="string">'line'</span>,</span><br><span class="line">        name: <span class="string">'频道数'</span>,</span><br><span class="line">        yAxisIndex: <span class="number">0</span>, <span class="comment">// 指定使用的y轴的index</span></span><br><span class="line">        data: [],</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        type: <span class="string">'bar'</span>,</span><br><span class="line">        name: <span class="string">'有效视频数'</span>,</span><br><span class="line">        yAxisIndex: <span class="number">1</span>, <span class="comment">// 指定使用的y轴的index</span></span><br><span class="line">        data: [],</span><br><span class="line">    &#125;,</span><br><span class="line">],</span><br></pre></td></tr></table></figure><p><strong>注意点</strong></p><ul><li>yAxis为数组，一个item对应一个y轴的配置</li><li>series的每个item都要添加<a href="https://echarts.apache.org/zh/option.html#series-line.yAxisIndex" target="_blank" rel="noopener"><code>yAxisIndex</code></a>字段，指定其使用的y轴的index</li></ul><h3 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h3><h4 id="设置上下边距"><a href="#设置上下边距" class="headerlink" title="设置上下边距"></a>设置上下边距</h4><p>饼图不能通过<code>grid</code>调整上下左右距离容器的距离，需要通过<code>series</code>中的<a href="https://echarts.apache.org/zh/option.html#series-pie.center" target="_blank" rel="noopener"><code>center</code></a>调整：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">center: [<span class="string">'50%'</span>, <span class="string">'50%'</span>]</span><br></pre></td></tr></table></figure><h4 id="圆环中间文字"><a href="#圆环中间文字" class="headerlink" title="圆环中间文字"></a>圆环中间文字</h4><p>配置文档：<a href="https://echarts.apache.org/zh/option.html#title.text" target="_blank" rel="noopener">https://echarts.apache.org/zh/option.html#title.text</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">title: &#123;</span><br><span class="line">    text: <span class="string">'渠道分布'</span>,</span><br><span class="line">    x: <span class="string">'center'</span>,</span><br><span class="line">    y: <span class="string">'center'</span>,</span><br><span class="line">    textStyle: &#123;</span><br><span class="line">       <span class="comment">// ...</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="圆环所有标签放在中心位置"><a href="#圆环所有标签放在中心位置" class="headerlink" title="圆环所有标签放在中心位置"></a>圆环所有标签放在中心位置</h4><p><a href="https://echarts.apache.org/zh/option.html#series-pie.label.position" target="_blank" rel="noopener">series-pie.label.position</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">series: [&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    avoidLabelOverlap: <span class="literal">false</span>,</span><br><span class="line">    label: &#123;</span><br><span class="line">        show: <span class="literal">false</span>,</span><br><span class="line">        position: <span class="string">'center'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    emphasis: &#123;</span><br><span class="line">        label: &#123;</span><br><span class="line">            show: <span class="literal">true</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><h4 id="扇形之间的间隔（描边）"><a href="#扇形之间的间隔（描边）" class="headerlink" title="扇形之间的间隔（描边）"></a>扇形之间的间隔（描边）</h4><p><a href="https://echarts.apache.org/zh/option.html#series-pie.itemStyle.borderWidth" target="_blank" rel="noopener">描边线宽</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">series: [&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    itemStyle: &#123;</span><br><span class="line">        borderColor: <span class="string">'#fff'</span>, </span><br><span class="line">        borderWidth: <span class="number">1</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><h4 id="不响应和触发鼠标事件（取消hover高亮、hover在扇区上的放大动画等）"><a href="#不响应和触发鼠标事件（取消hover高亮、hover在扇区上的放大动画等）" class="headerlink" title="不响应和触发鼠标事件（取消hover高亮、hover在扇区上的放大动画等）"></a>不响应和触发鼠标事件（取消hover高亮、hover在扇区上的放大动画等）</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    type: <span class="string">'pie'</span>,</span><br><span class="line">    silent: <span class="literal">true</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="渲染企业微信通讯录数据"><a href="#渲染企业微信通讯录数据" class="headerlink" title="渲染企业微信通讯录数据"></a>渲染企业微信通讯录数据</h3><p><a href="https://work.weixin.qq.com/api/doc/90001/90143/91958#4.%20canvas%20%E6%94%AF%E6%8C%81%E6%96%B9%E6%A1%88" target="_blank" rel="noopener">企业微信API：Canvas 支持方案</a></p><p><a href="https://open.work.weixin.qq.com/wwopen/common/readDocument/20085" target="_blank" rel="noopener">open-data 控件 demo</a></p><h4 id="tooltip-无法正确渲染通讯录数据，显示的是乱码"><a href="#tooltip-无法正确渲染通讯录数据，显示的是乱码" class="headerlink" title="tooltip 无法正确渲染通讯录数据，显示的是乱码"></a>tooltip 无法正确渲染通讯录数据，显示的是乱码</h4><p>解决方法：设置<code>renderMode: &#39;richText&#39;</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tooltip: &#123;</span><br><span class="line">   renderMode: <span class="string">'richText'</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="问题汇总"><a href="#问题汇总" class="headerlink" title="问题汇总"></a>问题汇总</h3><h4 id="Component-legend-scroll-not-exists-Load-it-first"><a href="#Component-legend-scroll-not-exists-Load-it-first" class="headerlink" title="Component legend.scroll not exists. Load it first."></a>Component legend.scroll not exists. Load it first.</h4><p>问题：按需引入<code>import &#39;echarts/lib/component/legend&#39;</code>后，设置legend<code>type: scroll</code>报错</p><p>解决：将缺少的legendScroll引入即可 <code>import &#39;echarts/lib/component/legendScroll&#39;</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;整理了一些工作中常用的ECharts配置。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://echarts.apache.org/examples/zh/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;examples&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://gallery.echartsjs.com/explore.html#sort=rank~timeframe=all~author=all&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Echarts Gallery&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;在react中使用Echarts：&lt;a href=&quot;https://github.com/hustcc/echarts-for-react&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;echarts-for-react&lt;/a&gt; &lt;/p&gt;</summary>
    
    
    
    <category term="Plugin" scheme="http://yoursite.com/categories/Plugin/"/>
    
    
    <category term="图表" scheme="http://yoursite.com/tags/图表/"/>
    
  </entry>
  
  <entry>
    <title>CSS文本特效</title>
    <link href="http://yoursite.com/2020/12/01/CSS-CSS%E6%96%87%E6%9C%AC%E7%89%B9%E6%95%88/"/>
    <id>http://yoursite.com/2020/12/01/CSS-CSS%E6%96%87%E6%9C%AC%E7%89%B9%E6%95%88/</id>
    <published>2020-12-01T03:38:58.000Z</published>
    <updated>2021-03-12T02:11:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>各种文本特效。</p><a id="more"></a><h3 id="颜色分割文本"><a href="#颜色分割文本" class="headerlink" title="颜色分割文本"></a>颜色分割文本</h3><h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h4><iframe height="265" style="width: 100%;" scrolling="no" title="CSS-Split Text" src="https://codepen.io/ly023/embed/XWjZVRW?height=265&theme-id=dark&default-tab=css,result" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">  See the Pen <a href="https://codepen.io/ly023/pen/XWjZVRW" target="_blank" rel="noopener">CSS-Split Text</a> by ly023  (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p><code>h1</code>添加<code>data</code>属性，存放伪元素文本：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">data-text</span>=<span class="string">"Split Colors"</span>&gt;</span>Split Colors<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用<code>polygon</code>来剪切伪元素文本，使其部分可见，然后设置绝对定位覆盖<code>h1</code>文本：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ff6161</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">attr</span>(data-text);</span><br><span class="line">  <span class="attribute">clip-path</span>: <span class="built_in">polygon</span>(<span class="number">100%</span> <span class="number">0%</span>, <span class="number">100%</span> <span class="number">100%</span>, <span class="number">0%</span> <span class="number">100%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后，确保文本是可选择的：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line"><span class="comment">/* ... */</span></span><br><span class="line"><span class="attribute">pointer-events</span>: none; <span class="comment">/* Make text selectable */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果没有<code>pointer-events</code>属性，<code>::before</code>伪元素文本将不能被选中。</p><h3 id="渐变文本"><a href="#渐变文本" class="headerlink" title="渐变文本"></a>渐变文本</h3><h4 id="效果-1"><a href="#效果-1" class="headerlink" title="效果"></a>效果</h4><iframe height="265" style="width: 100%;" scrolling="no" title="CSS-background-clip: text" src="https://codepen.io/ly023/embed/yLJaGOp?height=265&theme-id=dark&default-tab=css,result" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">  See the Pen <a href="https://codepen.io/ly023/pen/yLJaGOp" target="_blank" rel="noopener">CSS-background-clip: text</a> by ly023  (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h4 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h4><p>通过<code>linear-gradient</code>设置渐变背景，然后通过<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/background-clip" target="_blank" rel="noopener"><code>background-clip: text</code></a>裁剪背景，最后设置文本颜色<code>color</code>透明或半透明使背景可见。</p><p>兼容性：<a href="https://www.caniuse.com/mdn-css_properties_background_background-clip" target="_blank" rel="noopener">background-clip</a></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">30deg</span>, #<span class="number">9</span>ED8DB <span class="number">40%</span>, #<span class="number">007</span>B82 <span class="number">60%</span>);</span><br><span class="line">  <span class="attribute">background-clip</span>: text;</span><br><span class="line">  <span class="attribute">-webkit-background-clip</span>: text;</span><br><span class="line">  <span class="attribute">color</span>: transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="动画渐变文本"><a href="#动画渐变文本" class="headerlink" title="动画渐变文本"></a>动画渐变文本</h3><p>在渐变文本的基础上添加动画。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">   <span class="comment">/* ... */</span></span><br><span class="line">   <span class="attribute">animation</span>: animatedGradient <span class="number">2s</span> infinite forwards;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> animatedGradient &#123;</span><br><span class="line">   <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">100%</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">300%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><iframe height="265" style="width: 100%;" scrolling="no" title="CSS-background-clip: text" src="https://codepen.io/ly023/embed/mdEraBP?height=265&theme-id=dark&default-tab=css,result" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">  See the Pen <a href="https://codepen.io/ly023/pen/mdEraBP" target="_blank" rel="noopener">CSS-background-clip: text</a> by ly023  (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="图像背景文字"><a href="#图像背景文字" class="headerlink" title="图像背景文字"></a>图像背景文字</h3><p>在渐变文本的基础上将文字的渐变背景修改为图像背景。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">   <span class="attribute">background</span>: <span class="built_in">url</span>(url) no-repeat <span class="number">50%</span>;</span><br><span class="line">   <span class="attribute">background-size</span>: cover;</span><br><span class="line">   <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><iframe height="265" style="width: 100%;" scrolling="no" title="CSS-Image Background Text" src="https://codepen.io/ly023/embed/ZEOpVPw?height=265&theme-id=dark&default-tab=css,result" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">  See the Pen <a href="https://codepen.io/ly023/pen/ZEOpVPw" target="_blank" rel="noopener">CSS-Image Background Text</a> by ly023  (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>) on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</iframe><h3 id="视频背景文字"><a href="#视频背景文字" class="headerlink" title="视频背景文字"></a>视频背景文字</h3><p>利用<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/mix-blend-mode" target="_blank" rel="noopener"><code>mix-blend-mode: screen</code></a>实现。</p><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="css,result" data-user="ly023" data-slug-hash="PoGxpKV" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Video Mask Text-视频背景文字">  <span>See the Pen <a href="https://codepen.io/ly023/pen/PoGxpKV" target="_blank" rel="noopener">  Video Mask Text-视频背景文字</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="文字霓虹灯效果"><a href="#文字霓虹灯效果" class="headerlink" title="文字霓虹灯效果"></a>文字霓虹灯效果</h3><p class="codepen" data-height="265" data-theme-id="dark" data-default-tab="css,result" data-user="ly023" data-slug-hash="JjReEzb" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Neon Text-文字霓虹灯效果">  <span>See the Pen <a href="https://codepen.io/ly023/pen/JjReEzb" target="_blank" rel="noopener">  Neon Text-文字霓虹灯效果</a> by ly023 (<a href="https://codepen.io/ly023" target="_blank" rel="noopener">@ly023</a>)  on <a href="https://codepen.io" target="_blank" rel="noopener">CodePen</a>.</span></p><script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://letsbuildui.dev/articles/css-text-effects-five-minimal-examples" target="_blank" rel="noopener">CSS Text Effects - Five Minimal Examples</a></p><p><a href="https://codepen.io/alphardex" target="_blank" rel="noopener">https://codepen.io/alphardex</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;各种文本特效。&lt;/p&gt;</summary>
    
    
    
    <category term="CSS" scheme="http://yoursite.com/categories/CSS/"/>
    
    
    <category term="CSS" scheme="http://yoursite.com/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>URL编码</title>
    <link href="http://yoursite.com/2020/10/09/JS-url-encoding/"/>
    <id>http://yoursite.com/2020/10/09/JS-url-encoding/</id>
    <published>2020-10-09T01:29:02.000Z</published>
    <updated>2020-10-18T08:05:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>Javascript编码函数：<code>escape()</code>、<code>encodeURI()</code>以及<code>encodeURIComponent()</code>。</p><a id="more"></a><blockquote><p>只有字母和数字<code>[0-9a-zA-Z]</code>、一些特殊符号<code>$-_.+!*&#39;(),</code>、以及某些保留字，才可以不经过编码直接用于URL。</p></blockquote><h3 id="encodeURI"><a href="#encodeURI" class="headerlink" title="encodeURI()"></a>encodeURI()</h3><p>对整个URL进行编码，因此除了常见的符号以外，对其他一些在网址中有特殊含义的符号<code>;/?:@&amp;=+$,#&#39;</code>不进行编码。编码后，它输出符号的utf-8形式，并且在每个字节前加上<code>%</code>。对应的解码函数是<code>decodeURI()</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">encodeURI</span>(<span class="string">"http://www.baidu.com?wd=what's wrong?"</span>) </span><br><span class="line"><span class="comment">// "http://www.baidu.com?wd=what's%20wrong?"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">encodeURI</span>(<span class="string">"春节"</span>)</span><br><span class="line"><span class="comment">// "%E6%98%A5%E8%8A%82"</span></span><br></pre></td></tr></table></figure><h3 id="encodeURIComponent"><a href="#encodeURIComponent" class="headerlink" title="encodeURIComponent()"></a>encodeURIComponent()</h3><p>与<code>encodeURI()</code>的区别是，它用于<strong>对URL的组成部分进行个别编码</strong>，而不用于对整个URL进行编码。因此，<code>;/?:@&amp;=+$,#</code>，这些在<code>encodeURI()</code>中不被编码的符号，在<code>encodeURIComponent()</code>中统统会被编码（不对单引号<code>&#39;</code>编码）。至于具体的编码方法，两者是一样。对应的解码函数是<code>decodeURIComponent()</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">encodeURIComponent</span>(<span class="string">"http://www.baidu.com?wd=what's wrong?"</span>)</span><br><span class="line"><span class="comment">//"http%3A%2F%2Fwww.baidu.com%3Fwd%3Dwhat's%20wrong%3F"</span></span><br></pre></td></tr></table></figure><p>在添加或提取url参数时注意对参数值进行<code>encodeURIComponent</code>和<code>decodeURIComponent</code>，避免参数值中包含特殊字符影响url解析。</p><h3 id="escape"><a href="#escape" class="headerlink" title="escape()"></a>escape()</h3><p><code>escape()</code>不能直接用于URL编码，现在已经不提倡使用。它的真正作用是返回一个字符的Unicode编码值。比如“春节”的返回结果是<code>%u6625%u8282</code>，也就是说在Unicode字符集中，“春”是第6625个（十六进制）字符，“节”是第8282个（十六进制）字符。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">escape</span>(<span class="string">"春节"</span>) <span class="comment">// "%u6625%u8282"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">escape</span>(<span class="string">"hello word"</span>) <span class="comment">// "hello%20word"</span></span><br></pre></td></tr></table></figure><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p>阮一峰的网络日志<a href="https://www.ruanyifeng.com/blog/2010/02/url_encoding.html" target="_blank" rel="noopener">关于URL编码</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Javascript编码函数：&lt;code&gt;escape()&lt;/code&gt;、&lt;code&gt;encodeURI()&lt;/code&gt;以及&lt;code&gt;encodeURIComponent()&lt;/code&gt;。&lt;/p&gt;</summary>
    
    
    
    <category term="JS" scheme="http://yoursite.com/categories/JS/"/>
    
    
  </entry>
  
</feed>
